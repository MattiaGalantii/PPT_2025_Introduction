<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/quarto-contrib/videojs/video.min.js"></script>
<link href="site_libs/quarto-contrib/videojs/video-js.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-6.7.2/all.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-6.7.2/latex-fontsize.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.8.25">

  <meta name="author" content="Mattia Galanti">
  <title>Python Crash Course for Practicum Process Technology ‚Äì Practicum Process Technology</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto-534cd8e3a96973385dffff3f4709048d.css">
  <link rel="stylesheet" href="styles.css">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-pointer/pointer.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-transition="zoom" class="quarto-title-block center">
  <h1 class="title">Practicum Process Technology</h1>
  <p class="subtitle">Introduction to Python Scientific Programming</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Mattia Galanti 
</div>
</div>
</div>

</section>
<section>
<section id="introduction" class="title-slide slide level1 center">
<h1><i class="fa-solid fa-person-chalkboard" aria-label="person-chalkboard"></i> Introduction</h1>
<p>Welcome to the ‚ÄúIntroduction to Python Scientific Programming for Practicum Process Technology‚Äù!</p>
<p>This course is designed to equip you with the <em>fundamental</em> skills and knowledge needed to effectively use Python for scientific computing and data analysis in the context of Practicum Process Technology course.</p>
</section>
<section id="about-the-lecturers" class="slide level2">
<h2>About the lecturers</h2>
<p><strong>Mattia Galanti</strong><br>
Eindhoven University of Technology (TU/e)<br>
üìß m.galanti@tue.nl<br>
üè¢ STW 0.35, Helix Building</p>
<p><br></p>
<p><strong>Dr.&nbsp;Ivo Roghair</strong><br>
Eindhoven University of Technology (TU/e)<br>
üìß i.roghair@tue.nl<br>
üè¢ STW 0.37, Helix Building</p>
<p><br></p>
<p>Feel free to reach out via email for any questions or assistance related to the course.</p>
</section>
<section id="what-will-we-do-in-this-crash-course" class="slide level2">
<h2>What will we do in this crash course?</h2>
<p>In this crash course, we will cover the following topics:</p>
<blockquote>

<ul>
<li class="fragment">Quick refresh about Python and scientific libraries (10-15 minutes)</li>
<li class="fragment">Modeling of dynamic systems, ODEs and Python implementations (45 minutes)</li>
<li class="fragment">Fitting models to data and parameter estimation (30 minutes)</li>
<li class="fragment">Hands-on exercises and real-world examples</li>
</ul>

</blockquote>
<div class="fragment">
<p>By the end of this course, you will have a solid foundation in Python programming for scientific applications, enabling you to tackle the challenges you‚Äôll find in the rest of the Practicum Process Technology course.</p>
</div>
</section>
<section id="why-python" class="slide level2">
<h2>Why Python?</h2>
<p>Python is a versatile and powerful programming language widely used in scientific computing and data analysis. Here are some reasons why Python is an excellent choice:</p>
<blockquote>

<ul>
<li class="fragment"><strong>Ease of Learning:</strong> Python has a simple and readable syntax, making it accessible for beginners.</li>
<li class="fragment"><strong>Extensive Libraries:</strong> Python has a rich ecosystem of libraries such as NumPy, SciPy, and Matplotlib that facilitate scientific computing and data visualization.</li>
<li class="fragment"><strong>Community Support:</strong> Python has a large and active community, providing ample resources, tutorials, and forums for learning and troubleshooting.</li>
<li class="fragment"><strong>It‚Äôs Free üòé:</strong> Python is open-source and free to use, making it accessible to everyone.</li>
</ul>

</blockquote>
<p><img data-src="https://www.python.org/static/community_logos/python-logo-inkscape.svg" class="absolute" style="bottom: 100px; right: 0px; "></p>

<div class="footer">
<p>Learn more: <a href="https://jakevdp.github.io/PythonDataScienceHandbook/">Python Data Science Handbook</a> by Jake VanderPlas</p>
</div>
<aside><div>
<p>Formerly, the faculty would endorse Matlab as a scripting language, but proficiency in Python is believed to be more valuable for trained engineers.</p>
</div></aside></section>
<section id="how-to-program-in-python" class="slide level2">
<h2>How to program in Python?</h2>
<p>In this course, we will primarily use Jupyter Notebooks for coding and exercises. Jupyter Notebooks provide an interactive environment that allows you to combine code, text, and visualizations in a single document.</p>
<div class="fragment">
<p>You can run Jupyter Notebooks locally on your computer using <a href="https://www.anaconda.com/products/distribution">Anaconda</a> or use cloud-based platforms such as <a href="https://colab.research.google.com/">Google Colab</a>.</p>
<blockquote>
<p>Follow the instructions provided in the course materials to set up your Python environment and get started with Jupyter Notebooks.</p>
</blockquote>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Any problems?</strong></p>
</div>
<div class="callout-content">
<p>Given the time limitations, I won‚Äôt address python installation and setup questions during the session. Following the setup instructions provided in the course materials is mandatory. Feel free to ask after class.</p>
</div>
</div>
</div>
</div>
</section>
<section id="lets-get-started" class="slide level2">
<h2><i class="fa-solid fa-flag-checkered" aria-label="flag-checkered"></i> Let‚Äôs get started!</h2>
</section></section>
<section>
<section id="python-recap" class="title-slide slide level1 center">
<h1><i class="fa-brands fa-python" aria-label="python"></i> Python Recap</h1>
<p>This section provides a brief recap of essential Python concepts and libraries that will be useful throughout the course.<br>
You may be already be familiar with these topics, but this serves as a quick refresher.</p>
<blockquote>

<ul>
<li>Native Data Structures</li>
<li>Control Structures and Functions</li>
<li>Classes and Object Oriented Programming (OOP)</li>
</ul>

</blockquote>
</section>
<section id="native-data-structures" class="slide level2" data-transition="slide-in none-out">
<h2>Native Data Structures</h2>
<p>Python offers several built-in data structures that are fundamental for programming:</p>
<div class="fragment">
<h3 id="lists-ordered-mutable-collections-of-items."><strong>Lists:</strong> Ordered, mutable collections of items.</h3>
<p>Example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1" data-code-line-numbers="1-3|4-5|1-5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a>my_list_of_numbers <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb1-2"><a></a>my_list_of_strings <span class="op">=</span> [<span class="st">"apple"</span>, <span class="st">"banana"</span>, <span class="st">"cherry"</span>]</span>
<span id="cb1-3"><a></a>my_list_of_booleans <span class="op">=</span> [<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>]</span>
<span id="cb1-4"><a></a>my_list_of_lists <span class="op">=</span> [[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>], []]</span>
<span id="cb1-5"><a></a>my_heterogeneous_list <span class="op">=</span> [<span class="dv">1</span>, <span class="st">"apple"</span>, <span class="fl">3.14</span>, <span class="va">True</span>, [<span class="dv">1</span>, <span class="dv">2</span>], {<span class="st">"a"</span>: <span class="dv">1</span>}]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="fragment">
<p><span class="py-green">Lists</span> can be <em>heterogeneous</em> (contain elements of different types), but <strong>whenever possible</strong> it‚Äôs best to keep them <em>homogeneous</em> (containing elements of the same type) for easier processing and compatibility with libraries like NumPy.</p>
</div>
</section>
<section id="native-data-structures-1" class="slide level2" data-transition="none-in none-out">
<h2>Native Data Structures</h2>
<p>Python offers several built-in data structures that are fundamental for programming:</p>
<div class="fragment">
<h3 data-transition="fade" id="tuples-ordered-immutable-collections-of-items."><strong>Tuples:</strong> Ordered, immutable collections of items.</h3>
<p>Example:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a>my_tuple <span class="op">=</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb2-2"><a></a>coordinate_point <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">4</span>)                  </span>
<span id="cb2-3"><a></a>record <span class="op">=</span> (<span class="st">"CO‚ÇÇ"</span>, <span class="fl">44.01</span>, <span class="st">"g/mol"</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="fragment">
<p>Use <span class="py-green">tuples</span> when you want to ensure that the data <strong>cannot</strong> be modified after creation, or to group related but different types of data together.</p>
</div>
<div class="fragment">
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Caution</strong></p>
</div>
<div class="callout-content">
<p>Tuples are immutable! Once created, you cannot change their values.</p>
<div id="56a94eae" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a></a>my_tuple <span class="op">=</span> (<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb3-2"><a></a>my_tuple[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">10</span>                 </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell fragment" data-execution_count="1">
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[105]</span><span class="ansi-green-fg">, line 2</span>
<span class="ansi-green-fg">      1</span> my_tuple = (<span class="ansi-green-fg">1</span>, <span class="ansi-green-fg">2</span>, <span class="ansi-green-fg">3</span>)
<span class="ansi-green-fg">----&gt; </span><span class="ansi-green-fg">2</span> <span class="ansi-yellow-bg">my_tuple</span><span class="ansi-yellow-bg">[</span><span class="ansi-green-fg ansi-yellow-bg">0</span><span class="ansi-yellow-bg">]</span> = <span class="ansi-green-fg">10</span>                 

<span class="ansi-red-fg">TypeError</span>: 'tuple' object does not support item assignment</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="native-data-structures-2" class="slide level2" data-transition="none-in slide-out">
<h2>Native Data Structures</h2>
<p>Python offers several built-in data structures that are fundamental for programming:</p>
<div class="fragment">
<h3 id="dictionaries-key-value-pairs-for-storing-data."><strong>Dictionaries:</strong> Key-value pairs for storing data.</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a>my_dict <span class="op">=</span> {<span class="st">'a'</span>: <span class="dv">1</span>, <span class="st">'b'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], <span class="st">'c'</span>: <span class="st">'hello'</span>}</span>
<span id="cb4-2"><a></a>exams_I_passed <span class="op">=</span> {</span>
<span id="cb4-3"><a></a>    <span class="st">'Numerical Methods'</span>: <span class="va">True</span>,</span>
<span id="cb4-4"><a></a>    <span class="st">'Physical Transport Phenomena'</span>: <span class="va">False</span>,</span>
<span id="cb4-5"><a></a>    <span class="st">'Chemical Reactors'</span>: <span class="va">True</span>,</span>
<span id="cb4-6"><a></a>    <span class="st">'Practicum Process Technology'</span>: nan</span>
<span id="cb4-7"><a></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="fragment">
<p><span class="py-green">Dictionaries</span> are useful for representing structured data and allow for efficient data retrieval using keys.</p>
<div id="fda3df36" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a></a>molecular_weights <span class="op">=</span> {</span>
<span id="cb5-2"><a></a>    <span class="st">'H2O'</span>: <span class="fl">18.015</span>,</span>
<span id="cb5-3"><a></a>    <span class="st">'CO2'</span>: <span class="fl">44.01</span>,</span>
<span id="cb5-4"><a></a>    <span class="st">'CH4'</span>: <span class="fl">16.04</span></span>
<span id="cb5-5"><a></a>}</span>
<span id="cb5-6"><a></a><span class="bu">print</span>(<span class="ss">f"Molecular weight of CO2: </span><span class="sc">{</span>molecular_weights[<span class="st">'CO2'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell fragment" data-execution_count="2">
<div class="cell-output cell-output-stdout">
<pre><code>Molecular weight of CO2: 44.01</code></pre>
</div>
</div>
</div>
</section>
<section id="control-structures-and-functions" class="slide level2" data-transition="slide-in none-out">
<h2>Control Structures and Functions</h2>
<p>Control structures and functions are essential for controlling the flow of a program and organizing code into reusable blocks.</p>
<div class="fragment">
<h3 id="if-else-statements"><strong>If-Else Statements:</strong></h3>
<p>Conditional execution of code blocks.</p>
<div id="6762304f" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a></a>temperature <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb7-2"><a></a><span class="cf">if</span> temperature <span class="op">&gt;</span> <span class="dv">30</span>:</span>
<span id="cb7-3"><a></a>    <span class="bu">print</span>(<span class="st">"It's hot outside!"</span>)</span>
<span id="cb7-4"><a></a><span class="cf">elif</span> temperature <span class="op">&lt;</span> <span class="dv">15</span>:</span>
<span id="cb7-5"><a></a>    <span class="bu">print</span>(<span class="st">"It's cold outside"</span>) </span>
<span id="cb7-6"><a></a><span class="cf">else</span>:</span>
<span id="cb7-7"><a></a>    <span class="bu">print</span>(<span class="st">"The weather is moderate."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell fragment" data-execution_count="3">
<div class="cell-output cell-output-stdout">
<pre><code>It's cold outside</code></pre>
</div>
</div>
</div>
</section>
<section id="control-structures-and-functions-1" class="slide level2" data-transition="none-in none-out">
<h2>Control Structures and Functions</h2>
<p>Control structures and functions are essential for controlling the flow of a program and organizing code into reusable blocks.</p>
<div class="fragment">
<h3 id="for-loops"><strong>For Loops:</strong></h3>
<p>Iterating over sequences (like lists or ranges).</p>
<div id="03b1d86f" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a></a><span class="cf">for</span> <span class="bu">iter</span> <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb9-2"><a></a>    <span class="bu">print</span>(<span class="ss">f"Iteration </span><span class="sc">{</span><span class="bu">iter</span><span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell fragment" data-execution_count="4">
<div class="cell-output cell-output-stdout">
<pre><code>Iteration 0
Iteration 1
Iteration 2
Iteration 3
Iteration 4</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Check out lists comprehensions for a more concise way to create lists using for loops:</p>
<div id="5c0cc7bd" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a></a>squares <span class="op">=</span> [x<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)]</span>
<span id="cb11-2"><a></a><span class="bu">print</span>(<span class="st">"Squares from 0 to 9:"</span>, squares)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell fragment" data-execution_count="5">
<div class="cell-output cell-output-stdout">
<pre><code>Squares from 0 to 9: [0, 1, 4, 9, 16, 25, 36, 49, 64, 81]</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="control-structures-and-functions-2" class="slide level2" data-transition="none-in none-out">
<h2>Control Structures and Functions</h2>
<p>Control structures and functions are essential for controlling the flow of a program and organizing code into reusable blocks.</p>
<div class="fragment">
<h3 id="while-loops"><strong>While Loops:</strong></h3>
<p>Repeating a block of code while a condition is true.</p>
<div id="44deb34a" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a></a>count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb13-2"><a></a><span class="cf">while</span> count <span class="op">&lt;</span> <span class="dv">5</span>:</span>
<span id="cb13-3"><a></a>    <span class="bu">print</span>(<span class="ss">f"Count is </span><span class="sc">{</span>count<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb13-4"><a></a>    count <span class="op">+=</span> <span class="dv">1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell fragment" data-execution_count="6">
<div class="cell-output cell-output-stdout">
<pre><code>Count is 0
Count is 1
Count is 2
Count is 3
Count is 4</code></pre>
</div>
</div>
</div>
</section>
<section id="control-structures-and-functions-3" class="slide level2" data-transition="none-in slide-out">
<h2>Control Structures and Functions</h2>
<p>Control structures and functions are essential for controlling the flow of a program and organizing code into reusable blocks.</p>
<div class="fragment">
<h3 id="functions"><strong>Functions:</strong></h3>
<p>Reusable blocks of code that perform a specific task.</p>
<div id="06fe1258" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a></a><span class="kw">def</span> this_function_is_kind(name):</span>
<span id="cb15-2"><a></a>    <span class="cf">return</span> <span class="ss">f"Hello, </span><span class="sc">{</span>name<span class="sc">}</span><span class="ss">, nice to see you again!"</span></span>
<span id="cb15-3"><a></a></span>
<span id="cb15-4"><a></a>my_name <span class="op">=</span> <span class="st">"Mattia"</span></span>
<span id="cb15-5"><a></a><span class="bu">print</span>(this_function_is_kind(my_name))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell fragment" data-execution_count="7">
<div class="cell-output cell-output-stdout">
<pre><code>Hello, Mattia, nice to see you again!</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Functions help in organizing code, improving readability, efficiency, and avoiding repetition.</p>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>They are going to be extensively used throughout this course, <strong>so make sure you are comfortable with them.</strong></p>
</div>
</div>
</div>
</div>
<div class="footer">
<p>Refresh your knowledge on functions:<br>
<a href="https://www.geeksforgeeks.org/python/python-functions/">Python Functions</a><br>
<a href="https://realpython.com/defining-your-own-python-function/">Defining Your Own Python Function</a></p>
</div>
</section>
<section id="classes" class="slide level2">
<h2><strong>Classes:</strong></h2>
<p>Sometimes, you may end up with many functions and data that are related to each other. In such cases, it is often useful to group them together into a single unit called a class.</p>
<p>A class is a <em>blueprint</em> for creating objects that share common properties and behaviors.</p>
<div class="fragment">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17" data-code-line-numbers="|1-6|8-18|20|21-23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a></a><span class="kw">class</span> Cat:</span>
<span id="cb17-2"><a></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, name, age, color):</span>
<span id="cb17-3"><a></a>        <span class="va">self</span>.name <span class="op">=</span> name</span>
<span id="cb17-4"><a></a>        <span class="va">self</span>.age <span class="op">=</span> age</span>
<span id="cb17-5"><a></a>        <span class="va">self</span>.color <span class="op">=</span> color</span>
<span id="cb17-6"><a></a>        <span class="va">self</span>.cuteness_level <span class="op">=</span> <span class="dv">999999999999</span></span>
<span id="cb17-7"><a></a></span>
<span id="cb17-8"><a></a>    <span class="kw">def</span> purr(<span class="va">self</span>):</span>
<span id="cb17-9"><a></a>        <span class="bu">print</span>(<span class="st">"Purr... üò∫üí§"</span>)</span>
<span id="cb17-10"><a></a>        <span class="cf">return</span> </span>
<span id="cb17-11"><a></a></span>
<span id="cb17-12"><a></a>    <span class="kw">def</span> scratch(<span class="va">self</span>):</span>
<span id="cb17-13"><a></a>        <span class="bu">print</span>(<span class="st">"Scratch! üòæüí¢"</span>)</span>
<span id="cb17-14"><a></a>        <span class="cf">return</span></span>
<span id="cb17-15"><a></a></span>
<span id="cb17-16"><a></a>    <span class="kw">def</span> unleash_cuteness(<span class="va">self</span>):</span>
<span id="cb17-17"><a></a>        <span class="bu">print</span>(<span class="st">"Awwwwwwwwwww!! SOOOO CUTE!!! üòª‚ú®üíñ"</span>)</span>
<span id="cb17-18"><a></a>        <span class="cf">return</span></span>
<span id="cb17-19"><a></a></span>
<span id="cb17-20"><a></a>my_cat <span class="op">=</span> Cat(<span class="st">"Arturo"</span>, <span class="dv">2</span>, <span class="st">"Gray"</span>)</span>
<span id="cb17-21"><a></a>my_cat.purr()</span>
<span id="cb17-22"><a></a>my_cat.scratch()</span>
<span id="cb17-23"><a></a>my_cat.unleash_cuteness()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="fragment">
<div id="2c59b876" class="cell" data-execution_count="8">
<div class="cell-output cell-output-stdout">
<pre><code>Purr... üò∫üí§
Scratch! üòæüí¢
Awwwwwwwwwww!! SOOOO CUTE!!! üòª‚ú®üíñ</code></pre>
</div>
</div>
</div>
</section>
<section class="slide level2">

<h3 id="is-it-necessary-to-use-classes">Is it necessary to use classes?</h3>
<ul>
<li><strong>Classes</strong> are the foundation of <em>object-oriented programming (OOP)</em>, used to group related data and behavior.<br>
</li>
<li>They help in <strong>organizing</strong>, <strong>maintaining</strong>, and <strong>modularizing</strong> the code, especially in large projects.</li>
<li>Most modern Python libraries (e.g., <code>NumPy</code>, <code>pandas</code>, <code>TensorFlow</code>) rely <strong>heavily</strong> on classes. Understanding them helps you navigate and extend such frameworks.<br>
</li>
</ul>
<div class="fragment">
<blockquote>

<ul>
<li class="fragment">In this course, you‚Äôre free to use functions and native data structures as much as you want. However, learning about classes will be <em>beneficial</em> for your overall programming skills. Therefore, we encourage you to explore and understand them as you progress through the course.</li>
</ul>

</blockquote>
</div>
<div class="footer">
<p>Learn more about classes:<br>
<a href="https://realpython.com/python-classes/">The power of classes</a><br>
<a href="https://realpython.com/python3-object-oriented-programming/">Object-oriented programming in Python</a></p>
</div>
</section></section>
<section>
<section id="essential-libraries-numpy-and-matplotlib" class="title-slide slide level1 center">
<h1><i class="fa-solid fa-calculator" aria-label="calculator"></i> Essential Libraries: NumPy and Matplotlib</h1>
<blockquote>
<p>Empower your Python workflow with two of the most essential libraries for scientific computing and data visualization.</p>
</blockquote>
<p>Together, these libraries form the foundation of modern scientific programming in Python.</p>
<div class="quarto-layout-panel" style="display:flex; justify-content:left; align-items:left; gap:80px; margin-top:1em;" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><img data-src="assets/numpy_logo.png" width="400"> <img data-src="assets/matplotlib_logo.png" width="400"></p>
</div>
</div>
</div>
<div class="footer">
<p>If you need a refresher, check out these guides:<br>
<a href="https://numpy.org/doc/1.25/user/absolute_beginners.html">NumPy: the absolute basics for beginners</a><br>
<a href="https://matplotlib.org/stable/contents.html">Matplotlib quick start guide</a></p>
</div>
</section>
<section id="numpy" class="slide level2">
<h2><i class="fa-solid fa-cubes" aria-label="cubes"></i> NumPy</h2>
<p><a href="https://numpy.org/doc/stable/">NumPy</a> is the fundamental package for scientific computing in Python. It provides multidimensional array objects, efficient and high-performance computations, mathematical functions, and other tools for working with arrays.</p>
<blockquote>
<p><code>import numpy as np</code></p>
</blockquote>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>If you have doubts when programming with NumPy, check out the <a href="https://numpy.org/doc/stable/user/index.html">NumPy User Guide</a> for comprehensive explanations and examples. In alternative, ask ChatGPT for a quick help!</p>
</div>
</div>
</div>
</section>
<section id="key-features" class="slide level2" data-transition="slide-in none-out" data-auto-animate="true">
<h2 data-id="quarto-animate-title"><i class="fa-solid fa-cubes" aria-label="cubes"></i> Key Features</h2>
<h3 id="ndarray">ndarray</h3>
<p>A powerful n-dimensional array object that allows for efficient storage and manipulation of large datasets.</p>
<div class="fragment">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb19" data-code-line-numbers="1,2,3,4|"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb19-1" class="hljs-ln-code"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-2" class="hljs-ln-code"><a></a>array_1d <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb19-3" class="hljs-ln-code"><a></a>array_2d <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb19-4" class="hljs-ln-code"><a></a>array_3d <span class="op">=</span> np.array([[[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]], [[<span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>]]])</span>
<span id="cb19-5" class="hljs-ln-code"><a></a></span>
<span id="cb19-6" class="hljs-ln-code"><a></a><span class="bu">print</span>(<span class="ss">f"1D array shape: </span><span class="sc">{</span>array_1d<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-7" class="hljs-ln-code"><a></a><span class="bu">print</span>(<span class="ss">f"2D array shape: </span><span class="sc">{</span>array_2d<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-8" class="hljs-ln-code"><a></a><span class="bu">print</span>(<span class="ss">f"3D array shape: </span><span class="sc">{</span>array_3d<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="fragment">
<div id="f8007407" class="cell" data-execution_count="9">
<div class="cell-output cell-output-stdout">
<pre><code>1D array shape: (5,)
2D array shape: (2, 3)
3D array shape: (2, 2, 2)</code></pre>
</div>
</div>
</div>
<div class="footer">
<p>If you need a refresher, check out these guides:<br>
<a href="https://numpy.org/doc/1.25/user/absolute_beginners.html">NumPy: the absolute basics for beginners</a></p>
</div>
</section>
<section id="key-features-1" class="slide level2" data-transition="none-in none-out" data-auto-animate="true">
<h2 data-id="quarto-animate-title"><i class="fa-solid fa-cubes" aria-label="cubes"></i> Key Features</h2>
<h3 id="ndarray-1">ndarray</h3>
<p>A powerful n-dimensional array object that allows for efficient storage and manipulation of large datasets.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb21-1" class="hljs-ln-code"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-2" class="hljs-ln-code"><a></a>array_1d <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb21-3" class="hljs-ln-code"><a></a>array_2d <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb21-4" class="hljs-ln-code"><a></a>array_3d <span class="op">=</span> np.array([[[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>]], [[<span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>]]])</span>
<span id="cb21-5" class="hljs-ln-code"><a></a></span>
<span id="cb21-6" class="hljs-ln-code"><a></a><span class="bu">print</span>(<span class="ss">f"1D array shape: </span><span class="sc">{</span>array_1d<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-7" class="hljs-ln-code"><a></a><span class="bu">print</span>(<span class="ss">f"2D array shape: </span><span class="sc">{</span>array_2d<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-8" class="hljs-ln-code"><a></a><span class="bu">print</span>(<span class="ss">f"3D array shape: </span><span class="sc">{</span>array_3d<span class="sc">.</span>shape<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-9" class="hljs-ln-code"><a></a></span>
<span id="cb21-10" class="hljs-ln-code"><a></a><span class="bu">print</span>(array_1d[<span class="dv">2</span>])       </span>
<span id="cb21-11" class="hljs-ln-code"><a></a><span class="bu">print</span>(array_2d[<span class="dv">1</span>, <span class="dv">0</span>])     </span>
<span id="cb21-12" class="hljs-ln-code"><a></a><span class="bu">print</span>(array_3d[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>])  </span>
<span id="cb21-13" class="hljs-ln-code"><a></a><span class="bu">print</span>(array_3d[:, <span class="dv">0</span>, :])  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="fragment">
<div id="cc8623f7" class="cell" data-execution_count="10">
<div class="cell-output cell-output-stdout">
<pre><code>1D array shape: (5,)
2D array shape: (2, 3)
3D array shape: (2, 2, 2)

Accessing 1D array: 3
Accessing 2D array: 4
Accessing 3D array: 4
Accessing multiple dimensions in 3D array: [[1 2]
 [5 6]]</code></pre>
</div>
</div>
</div>
<div class="footer">
<p>If you need a refresher, check out these guides:<br>
<a href="https://numpy.org/doc/1.25/user/absolute_beginners.html">NumPy: the absolute basics for beginners</a></p>
</div>
</section>
<section id="key-features-2" class="slide level2" data-transition="none-in none-out">
<h2><i class="fa-solid fa-cubes" aria-label="cubes"></i> Key Features</h2>
<h3 id="vectorized-operations">Vectorized Operations</h3>
<p>NumPy performs <strong>element-wise operations</strong> on entire arrays, eliminating explicit Python loops and providing major speed-ups.</p>
<div class="fragment">
<div id="0b69188c" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb23-2"><a></a></span>
<span id="cb23-3"><a></a><span class="co"># Two arrays (same shape)</span></span>
<span id="cb23-4"><a></a>a <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb23-5"><a></a>b <span class="op">=</span> np.array([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>])</span>
<span id="cb23-6"><a></a></span>
<span id="cb23-7"><a></a><span class="co"># Element-wise math</span></span>
<span id="cb23-8"><a></a>sum_ab   <span class="op">=</span> a <span class="op">+</span> b</span>
<span id="cb23-9"><a></a>product  <span class="op">=</span> a <span class="op">*</span> b</span>
<span id="cb23-10"><a></a>squared  <span class="op">=</span> a <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb23-11"><a></a></span>
<span id="cb23-12"><a></a><span class="bu">print</span>(<span class="st">"Sum:"</span>, sum_ab)</span>
<span id="cb23-13"><a></a><span class="bu">print</span>(<span class="st">"Product:"</span>, product)</span>
<span id="cb23-14"><a></a><span class="bu">print</span>(<span class="st">"Squared:"</span>, squared)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell fragment" data-execution_count="11">
<div class="cell-output cell-output-stdout">
<pre><code>Sum: [11 22 33 44 55]
Product: [ 10  40  90 160 250]
Squared: [ 1  4  9 16 25]</code></pre>
</div>
</div>
</div>
<div class="footer">
<p>If you need a refresher, check out these guides:<br>
<a href="https://numpy.org/doc/1.25/user/absolute_beginners.html">NumPy: the absolute basics for beginners</a></p>
</div>
</section>
<section id="key-features-3" class="slide level2" data-transition="none-in none-out">
<h2><i class="fa-solid fa-cubes" aria-label="cubes"></i> Key Features</h2>
<h3 id="broadcasting">Broadcasting</h3>
<p>An (<em>overpowered</em>) mechanism that allows NumPy to perform operations on arrays of <strong>different shapes</strong> in a way that is both efficient and intuitive. Every operation happens element-wise and in C-optimized code.</p>
<div class="fragment">
<div id="1ca2a825" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb25-2"><a></a><span class="co"># Array of shape (3, 4)</span></span>
<span id="cb25-3"><a></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb25-4"><a></a>              [<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>],</span>
<span id="cb25-5"><a></a>              [<span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]])</span>
<span id="cb25-6"><a></a><span class="co"># Array of shape (4,)</span></span>
<span id="cb25-7"><a></a>b <span class="op">=</span> np.array([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>])</span>
<span id="cb25-8"><a></a><span class="co"># Broadcasting addition</span></span>
<span id="cb25-9"><a></a>C <span class="op">=</span> A <span class="op">+</span> b</span>
<span id="cb25-10"><a></a><span class="bu">print</span>(<span class="st">"Result of Broadcasting Addition:</span><span class="ch">\n</span><span class="st">"</span>, C)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell fragment" data-execution_count="12">
<div class="cell-output cell-output-stdout">
<pre><code>Result of Broadcasting Addition:
 [[11 22 33 44]
 [15 26 37 48]
 [19 30 41 52]]</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div style="font-size:0.8em;">
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>Broadcasting allows NumPy to automatically expand the smaller array (b) across the larger array (A) so that they have compatible shapes for element-wise operations.</p>
</div>
</div>
</div>
</div>
</div>
<div class="footer">
<p>Learn more about broadcasting here:<br>
<a href="https://www.youtube.com/watch?v=P67wiuTx7l0">Learn NumPy broadcasting in 6 minutes!</a> from youTube channel <em>Bro Code</em></p>
<p><a href="https://medium.com/@rohanmistry231/numpy-broadcasting-explained-the-complete-guide-for-beginners-and-data-enthusiasts-36fb9790ad0d">NumPy Broadcasting Explained: The Complete Guide for Beginners and Data Enthusiasts</a> from Medium.com, <em>Rohan Mistry</em></p>
</div>
</section>
<section id="key-features-4" class="slide level2" data-transition="none-in none-out">
<h2><i class="fa-solid fa-cubes" aria-label="cubes"></i> Key Features</h2>
<h3 id="mathematical-functions">Mathematical Functions</h3>
<p>A wide range of mathematical functions for performing operations on arrays, including linear algebra, statistical analysis, and more.</p>
<div class="fragment" style="font-size:0.85em;">
<div id="3bbf232b" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb27-2"><a></a>data <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>], [<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>]])</span>
<span id="cb27-3"><a></a>mean <span class="op">=</span> np.mean(data, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb27-4"><a></a>std_dev <span class="op">=</span> np.std(data, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb27-5"><a></a>exp <span class="op">=</span> np.exp(data)</span>
<span id="cb27-6"><a></a>sum_data <span class="op">=</span> np.<span class="bu">sum</span>(data, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb27-7"><a></a><span class="bu">print</span>(<span class="ss">f"Mean: </span><span class="sc">{</span>mean<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss">Standard Deviation: </span><span class="sc">{</span>std_dev<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss">Sum: </span><span class="sc">{</span>sum_data<span class="sc">}</span><span class="ss"> </span><span class="ch">\n</span><span class="ss">Exponential: </span><span class="sc">{</span>exp<span class="sc">}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell fragment" data-execution_count="13">
<div class="cell-output cell-output-stdout">
<pre><code>Mean: [3. 8.] 
Standard Deviation: [1.41421356 1.41421356] 
Sum: [15 40] 
Exponential: [[2.71828183e+00 7.38905610e+00 2.00855369e+01 5.45981500e+01
  1.48413159e+02]
 [4.03428793e+02 1.09663316e+03 2.98095799e+03 8.10308393e+03
  2.20264658e+04]]</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>When working with multidimensional arrays, you can specify the <strong>axis</strong> along which to perform the operation using the <code>axis</code> parameter in functions like <code>np.sum()</code>, <code>np.mean()</code>, etc.</p>
</div>
</div>
</div>
</div>
<div class="footer">
<p>If you need a refresher, check out these guides:<br>
<a href="https://numpy.org/doc/1.25/user/absolute_beginners.html">NumPy: the absolute basics for beginners</a></p>
</div>
<p><br>
</p>
</section>
<section id="key-features-5" class="slide level2" data-transition="none-in slide-out">
<h2><i class="fa-solid fa-cubes" aria-label="cubes"></i> Key Features</h2>
<h3 id="integration-with-other-libraries">Integration with Other Libraries</h3>
<blockquote>
<p>NumPy serves as the foundation for many other scientific computing libraries in Python, such as SciPy, pandas, and scikit-learn.</p>
</blockquote>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p>Be sure to be familiar with NumPy, since it‚Äôs the backbone of scientific computing in Python!</p>
</div>
</div>
</div>
<div class="footer">
<p>If you need a refresher, check out these guides:<br>
<a href="https://numpy.org/doc/1.25/user/absolute_beginners.html">NumPy: the absolute basics for beginners</a></p>
</div>
</section>
<section id="matplotlib" class="slide level2">
<h2><i class="fa-solid fa-chart-line" aria-label="chart-line"></i> Matplotlib</h2>
<p><a href="https://matplotlib.org/stable/contents.html">Matplotlib</a> is a comprehensive library for creating static, animated, and interactive visualizations in Python. It provides a wide range of plotting capabilities, allowing you to create high-quality graphs and charts for data analysis and presentation.</p>
<blockquote>
<p><code>from matplotlib import pyplot as plt</code></p>
</blockquote>
<blockquote>
<p><code>import matplotlib.pyplot as plt</code></p>
</blockquote>
</section>
<section id="matplotlib-basics" class="slide level2" data-transition="slide-in none-out">
<h2><i class="fa-solid fa-chart-line" aria-label="chart-line"></i> Matplotlib Basics</h2>
<p><a href="https://matplotlib.org/stable/contents.html">Matplotlib</a> lets you visualize data with just a few lines of code.</p>
<div class="fragment" style="font-size:0.85em;">
<div id="de514b1c" class="cell columns column-output-location" data-execution_count="14">
<div class="column">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb29-2"><a></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb29-3"><a></a></span>
<span id="cb29-4"><a></a><span class="co"># Generate data</span></span>
<span id="cb29-5"><a></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb29-6"><a></a>y1 <span class="op">=</span> np.sin(x)</span>
<span id="cb29-7"><a></a>y2 <span class="op">=</span> np.cos(x)</span>
<span id="cb29-8"><a></a></span>
<span id="cb29-9"><a></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb29-10"><a></a></span>
<span id="cb29-11"><a></a>ax.plot(x, y1, label<span class="op">=</span><span class="st">'Sin(x)'</span>, color<span class="op">=</span><span class="st">'blue'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb29-12"><a></a>ax.plot(x, y2, label<span class="op">=</span><span class="st">'Cos(x)'</span>, color<span class="op">=</span><span class="st">'red'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb29-13"><a></a>ax.fill_between(x, y1, y2, alpha<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb29-14"><a></a></span>
<span id="cb29-15"><a></a>ax.set_title(<span class="st">'Trigonometric Functions'</span>)</span>
<span id="cb29-16"><a></a>ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb29-17"><a></a>ax.set_ylabel(<span class="st">'y'</span>)</span>
<span id="cb29-18"><a></a>ax.legend()</span>
<span id="cb29-19"><a></a>ax.grid(<span class="va">True</span>)</span>
<span id="cb29-20"><a></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div><div class="column fragment">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/cell-15-output-1.png" width="832" height="523"></p>
</figure>
</div>
</div>
</div></div>
</div>
</section>
<section id="matplotlib-in-action" class="slide level2" data-transition="slide-in fade-out">
<h2><i class="fa-solid fa-chart-line" aria-label="chart-line"></i> Matplotlib in Action</h2>
<p>Matplotlib supports rich styling: color maps, transparency, annotations, and more. Perfect for high-quality visual analysis!</p>
<div class="fragment">
<div id="af41dcb4" class="cell columns column-output-location" data-execution_count="15">
<div class="column">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-2"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb30-3"><a></a></span>
<span id="cb30-4"><a></a><span class="co"># Generate synthetic data</span></span>
<span id="cb30-5"><a></a>np.random.seed(<span class="dv">0</span>)</span>
<span id="cb30-6"><a></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">200</span>)</span>
<span id="cb30-7"><a></a>y <span class="op">=</span> np.sin(x) <span class="op">+</span> np.random.normal(<span class="dv">0</span>, <span class="fl">0.2</span>, size<span class="op">=</span>x.size)</span>
<span id="cb30-8"><a></a>colors <span class="op">=</span> y  <span class="co"># color by value</span></span>
<span id="cb30-9"><a></a>sizes <span class="op">=</span> <span class="dv">80</span> <span class="op">*</span> np.<span class="bu">abs</span>(y) <span class="op">+</span> <span class="dv">10</span>  <span class="co"># scale by magnitude</span></span>
<span id="cb30-10"><a></a></span>
<span id="cb30-11"><a></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">5</span>))</span>
<span id="cb30-12"><a></a>scatter <span class="op">=</span> plt.scatter(x, y, c<span class="op">=</span>colors, s<span class="op">=</span>sizes, cmap<span class="op">=</span><span class="st">"viridis"</span>, alpha<span class="op">=</span><span class="fl">0.8</span>, edgecolors<span class="op">=</span><span class="st">"k"</span>)</span>
<span id="cb30-13"><a></a></span>
<span id="cb30-14"><a></a><span class="co"># Add a colorbar and labels</span></span>
<span id="cb30-15"><a></a>plt.colorbar(scatter, label<span class="op">=</span><span class="st">"y value"</span>)</span>
<span id="cb30-16"><a></a>plt.title(<span class="st">"Fancy sine function with noise"</span>, fontsize<span class="op">=</span><span class="dv">14</span>, pad<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb30-17"><a></a>plt.xlabel(<span class="st">"x"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb30-18"><a></a>plt.ylabel(<span class="st">"y"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb30-19"><a></a></span>
<span id="cb30-20"><a></a><span class="co"># Add a highlight annotation</span></span>
<span id="cb30-21"><a></a>idx <span class="op">=</span> np.argmax(y)</span>
<span id="cb30-22"><a></a>plt.scatter(x[idx], y[idx], color<span class="op">=</span><span class="st">"red"</span>, s<span class="op">=</span><span class="dv">200</span>, edgecolors<span class="op">=</span><span class="st">"white"</span>, zorder<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb30-23"><a></a>plt.annotate(<span class="st">"Peak!"</span>, (x[idx], y[idx]), textcoords<span class="op">=</span><span class="st">"offset points"</span>, xytext<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">10</span>), color<span class="op">=</span><span class="st">"red"</span>, fontsize<span class="op">=</span><span class="dv">12</span>)</span>
<span id="cb30-24"><a></a></span>
<span id="cb30-25"><a></a>plt.grid(alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb30-26"><a></a>plt.tight_layout()</span>
<span id="cb30-27"><a></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div><div class="column fragment">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/cell-16-output-1.png" width="736" height="469"></p>
</figure>
</div>
</div>
</div></div>
</div>
</section></section>
<section>
<section id="an-introduction-to-ordinary-differential-equations" class="title-slide slide level1 center">
<h1><i class="fa-solid fa-infinity" aria-label="infinity"></i> An Introduction to Ordinary Differential Equations</h1>
<blockquote>
<p>This section aims to provide a foundational understanding of Ordinary Differential Equations (ODEs), their significance in various fields, and how to solve them using Python.</p>
</blockquote>
</section>
<section id="dynamical-systems" class="slide level2">
<h2>Dynamical Systems</h2>
<p>Every system that evolves over time can be described as a <em>dynamical system</em>.</p>
<div class="fragment fade-left">
<blockquote>
<p>The word <em>dynamical</em> comes from the Greek Œ¥œçŒΩŒ±ŒºŒπœÇ (d√Ωnamis), which means power, potential, or capacity to act. So dynamical literally refers to something in the process of becoming, something that has the power to change.</p>
</blockquote>
<p><img data-src="assets/aristotele.png" alt="Aristotle" width="300"></p>
</div>
<div class="footer">
<blockquote>
<p>‚ÄúThe more you know, the more you realize you don‚Äôt know.‚Äù - Aristotle Image generated with chatGPT</p>
</blockquote>
</div>
</section>
<section id="why-dynamical-systems-matter" class="slide level2">
<h2>Why Dynamical Systems Matter</h2>
<p>If you think about it, almost every process in nature and engineering changes with time, therefore following the <strong>rules of change</strong>.</p>
<div class="fragment">
<blockquote>
<p>These rules tell us not what <em>is</em>, but what will be <em>next</em>.</p>
</blockquote>
</div>
<div class="fragment">
<p>Therefore, these rules will allow us to predict the future, given we know the present. <img data-src="assets/galaxy_brain.png" alt="Galaxy Brain" width="400"></p>
</div>
</section>
<section id="the-system-state" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">The System State</h2>
<p>We start with a simple idea: <strong>everything changes with time</strong>.<br>
At any moment, a system has a <strong>state</strong> (its position, temperature, or concentration) and this state evolves continuously.</p>
<div class="columns">
<div class="column">
<div class="fragment fade-left">
<p>Mathematically, we can describe the state as a vector:</p>
<p><span class="math display">\[
\mathbf{x}(t) =
\begin{bmatrix}
x_1(t) \\[4pt]
x_2(t) \\[2pt]
\vdots \\[2pt]
x_n(t)
\end{bmatrix}
\]</span></p>
</div>
</div><div class="column">
<div class="fragment fade-left">
<p>and the rule of change as:</p>
<p><span class="math display">\[
\frac{d\mathbf{x}}{dt} = F(\mathbf{x}, t)
\]</span></p>
<p>where <span class="math inline">\(F\)</span> describes how the state changes over time.</p>
</div>
</div></div>
<div class="fragment fade-left">
<p>Given <span class="math inline">\(\mathbf{x}(t_0)=\mathbf{x}_0\)</span> and <span class="math inline">\(F(\mathbf{x}, t)\)</span> we can predict the system‚Äôs future evolution.<br>
We‚Äôve written an <strong>Ordinary Differential Equation</strong>.</p>
</div>
</section>
<section id="what-are-odes" class="slide level2 nostretch">
<h2>What are ODEs?</h2>
<p>ODEs are the mathematical representation of these rules of change. They relate a function (the state of the system) to its derivatives (the rates of change of the system).</p>
<p>They‚Äôre astonishingly powerful.</p>
<p><img data-src="assets/time_machine.png" class="nostretch" width="500"></p>
<div style="font-size:0.9em;">
<div class="callout callout-note callout-style-simple">
<div class="callout-body">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-content">
<p>We define the initial value problem (IVP) for an ODE as: <span class="math display">\[
\frac{d\mathbf{x}}{dt} = F(\mathbf{x}, t), \quad \mathbf{x}(t_0) = \mathbf{x}_0
\]</span></p>
</div>
</div>
</div>
</div>
<!-- This is why I like to think of ODEs as time machines. You feed in the present, and the laws of change compute what happens next, and next, and next‚Ä¶ until you can see (or should I say *predict*) the future unrolling. Of course, the accuracy of our time machine prediction depends on how well we understand the underlying processes and how accurately we can model them. -->
</section>
<section id="odes-and-condition-of-existence-and-uniqueness" class="slide level2">
<h2>ODEs and Condition of existence and uniqueness</h2>
<p>For an ODE to have a <em>unique solution</em>, certain conditions must be met.</p>
<div class="fragment">
<p>These conditions are often related to the continuity and differentiability of the functions involved, explained in the Existence and Uniqueness Theorem (Picard-Lindel√∂f theorem):</p>
<div title="Existence and Uniqueness Theorem (Picard‚ÄìLindel√∂f)">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Existence and Uniqueness Theorem (Picard‚ÄìLindel√∂f)</strong></p>
</div>
<div class="callout-content">
<p>Consider the initial value problem</p>
<p><span class="math display">\[
\dot{x} = f(x), \quad x(0) = x_0.
\]</span></p>
<p>Suppose that <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(f'(x)\)</span> are continuous on an open interval <span class="math inline">\(R\)</span> of the x-axis, and suppose that <span class="math inline">\(x_0\)</span> is a point in <span class="math inline">\(R\)</span>.<br>
Then the initial value problem has a solution <span class="math inline">\(x(t)\)</span> on some time interval <span class="math inline">\((- \tau, \tau)\)</span> about <span class="math inline">\(t = 0\)</span>, and the solution is unique.</p>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>This theorem says that if <span class="math inline">\(f(x)\)</span> is smooth enough, then solutions exist and are unique.</p>
<p>(<em>Even so, there‚Äôs no guarantee that solutions exist forever..</em>)</p>
</div>
<div class="footer">
<p>If you want to read more about it, check <a href="https://encyclopediaofmath.org/wiki/Cauchy-Lipschitz_theorem">Encyclopedia of Mathematics</a></p>
</div>
</section>


<section id="linear-odes" class="slide level2">
<h2>Linear ODEs</h2>
<p>A <strong>linear ordinary differential equation (ODE)</strong> is one that can be written in the form:</p>
<p><span class="math display">\[
a_n(t)\,\frac{d^n y}{dt^n} + a_{n-1}(t)\,\frac{d^{n-1} y}{dt^{n-1}} + \dots + a_1(t)\,\frac{dy}{dt} + a_0(t)\,y = g(t)
\]</span></p>
<p>where the coefficients <span class="math inline">\(a_i(t)\)</span> and the forcing term <span class="math inline">\(g(t)\)</span> are known functions of the independent variable <span class="math inline">\(t\)</span>.</p>
<h3 id="key-properties">Key properties</h3>
<ul>
<li class="fragment">The dependent variable <span class="math inline">\(y\)</span> <strong>and its derivatives</strong> appear <strong>only to the first power</strong>.</li>
<li class="fragment"><span class="math inline">\(y\)</span> and its derivatives are <strong>not multiplied</strong> together.</li>
<li class="fragment"><em>Usually</em>, can be solved analytically</li>
<li class="fragment">Superposition holds:<br>
if <span class="math inline">\(y_1\)</span> and <span class="math inline">\(y_2\)</span> are solutions of the homogeneous equation, then <span class="math inline">\(c_1 y_1 + c_2 y_2\)</span> is also a solution.</li>
</ul>
</section>
<section id="nonlinear-odes" class="slide level2">
<h2>Nonlinear ODEs</h2>
<p>A <strong>non-linear ODE</strong> involves terms that are nonlinear functions of <span class="math inline">\(y\)</span> or its derivatives,<br>
for example, <span class="math inline">\(y^2\)</span>, <span class="math inline">\(y\,\frac{dy}{dt}\)</span>, or <span class="math inline">\(\sin(y)\)</span>.</p>
<p>Nonlinear equations often describe richer and more complex dynamics (e.g., oscillations, bifurcations and chaos).</p>
<p>Typically <strong>cannot be solved analytically</strong> and must be studied using <strong>numerical methods</strong> or <strong>approximations</strong>.</p>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="assets/strange_attractor.png" class="fade-left" alt="Lorenz strange attractor" width="300"></p>
<figcaption>Strange Attractor</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="assets/mendelbrot_set.png" class="fade-left" alt="Mandelbrot set" width="400"></p>
<figcaption>Mandelbrot Set (kinda)</figcaption>
</figure>
</div>
</div>
</div>
<div class="fragment fade-left quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<p><span class="math display">\[
\frac{du}{dt} = \frac{1}{\tau} \left(u_{in} - u\right) + k\,u
\]</span></p>
<p><span class="math display">\[
\frac{d^2 \theta}{dt^2} + \sin(\theta) = 0
\]</span></p>
<p><span style="font-size:0.9em; color:gray;"><em>Linear vs.&nbsp;Nonlinear</em></span></p>
</div>
</div>
</div>
<div class="footer">
<blockquote>
<p>‚ÄúMost of everyday life is nonlinear, and the principle of superposition fails spectacularly.‚Äù - Steven Strogatz</p>
</blockquote>
</div>
</section>
<section id="solving-odes-numerically" class="slide level2">
<h2>Solving ODEs Numerically</h2>
<p>Imagine you have a first-order ODE of the form: <span class="math display">\[
\frac{d\theta}{dt} = \sin(\theta)
\]</span></p>
<p>with an initial condition <span class="math inline">\(\theta(t=0) = \theta_0\)</span>.</p>
<p>Imagine <span class="math inline">\(\theta\)</span> represents the angular position of a particle moving along a line over time <span class="math inline">\(t\)</span>.</p>
<div class="fragment fade-left">
<blockquote>
<p>Knowing the rule of change, specifically <span class="math inline">\(\frac{d\theta}{dt}\)</span>, already allows us to predict the particle‚Äôs future behaviour without using any integrals!</p>
</blockquote>
</div>
</section>
<section id="the-power-of-knowing-the-derivative" class="slide level2" data-transition="none-in none-out">
<h2>The power of knowing the derivative</h2>
<h3 id="the-phase-space">The phase-space</h3>
<p>By knowing the derivative <span class="math inline">\(\frac{d\theta}{dt} = \sin(\theta)\)</span>, we can analyze the system‚Äôs behavior in phase space:</p>
<div id="70d55a37" class="cell" data-execution_count="16">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/cell-17-output-1.png" width="755" height="469"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-power-of-knowing-the-derivative-1" class="slide level2" data-transition="none-in none-out">
<h2>The power of knowing the derivative</h2>
<h3 id="the-phase-space-1">The phase-space</h3>
<p>By knowing the derivative <span class="math inline">\(\frac{d\theta}{dt} = \sin(\theta)\)</span>, we can analyze the system‚Äôs behavior in phase space:</p>
<div id="5c92bd42" class="cell" data-execution_count="17">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/cell-18-output-1.png" width="755" height="469"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-power-of-knowing-the-derivative-2" class="slide level2" data-transition="none-in none-out">
<h2>The power of knowing the derivative</h2>
<h3 id="the-phase-space-2">The phase-space</h3>
<p>By knowing the derivative <span class="math inline">\(\frac{d\theta}{dt} = \sin(\theta)\)</span>, we can analyze the system‚Äôs behavior in phase space:</p>
<div id="2d2a024d" class="cell" data-execution_count="18">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/cell-19-output-1.png" width="755" height="469"></p>
</figure>
</div>
</div>
</div>
<div class="fragment fade-left">
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p><strong>Intuition</strong>: knowing the derivative allows us to predict the system‚Äôs behavior without solving the ODE explicitly!</p>
</div>
</div>
</div>
</div>
</section>
<section id="eulers-method" class="slide level2">
<h2>Euler‚Äôs Method</h2>
<p>We were able to predict the system‚Äôs behavior <em>qualitatively</em> by analyzing the phase space.</p>
<div class="fragment">
<p>Similarly, to obtain a <em>quantitative</em> solution, we can use the same intuituion to approximate the solution numerically using <strong>Euler‚Äôs Method</strong>.</p>
<p><img data-src="assets/euler.png" alt="Euler_meme" width="400"></p>
</div>
</section>
<section id="the-idea-behind-eulers-method" class="slide level2">
<h2>The idea behind Euler‚Äôs Method</h2>
<p>We know the differential equation describes a <em>velocity field</em>:</p>
<p><span class="math display">\[
\frac{dx}{dt} = f(x)
\]</span></p>
<p>At each point <span class="math inline">\(x\)</span>, the function <span class="math inline">\(f(x)\)</span> tells us how fast and in which direction <span class="math inline">\(x\)</span> changes.</p>
<div class="fragment fade-left">
<p>If we start from <span class="math inline">\(x_0\)</span> at <span class="math inline">\(t_0\)</span>, and move a small time step <span class="math inline">\(\Delta t\)</span>, the <strong>displacement</strong> is approximately the <em>local velocity</em> times <span class="math inline">\(\Delta t\)</span>:</p>
<p><span class="math display">\[
x(t_0 + \Delta t) \approx x_0 + f(x_0)\,\Delta t
\]</span></p>
</div>
</section>
<section id="iterating-the-idea" class="slide level2" data-transition="none-in none-out">
<h2>Iterating the idea</h2>
<p>By repeating the same reasoning step-by-step, we generate a sequence:</p>
<p><span class="math display">\[
x_{n+1} = x_n + f(x_n)\,\Delta t
\]</span></p>
<p>Each step uses the <em>current slope</em> to estimate the <em>next position</em>.</p>
<div id="0ded6345" class="cell" data-execution_count="19">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/cell-20-output-1.png" width="757" height="468"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="however" class="slide level2">
<h2>However‚Ä¶</h2>
<ul>
<li class="fragment">The accuracy of Euler‚Äôs method depends on the step size <span class="math inline">\(\Delta t\)</span>.</li>
<li class="fragment">When you have different time scales in the system, Euler‚Äôs method may require <em>impractically</em> small step sizes to maintain stability and accuracy.</li>
</ul>
<div class="fragment">
<p>Numerically, an ODE is considered <strong>stiff</strong> if it exhibits behavior on vastly different time scales, making it challenging for standard <em>numerical</em> methods to solve efficiently.</p>
<div class="fragment fade-left">
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>In chemical engineering, stiff equations are the standard rather than the exception, often arising from reaction kinetics and transport phenomena.</p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="example-stiffness-and-step-size" class="slide level2" data-transition="fade-in slide-out">
<h2>Example: stiffness and step size</h2>
<p>Let‚Äôs test the Euler method on a <strong>stiff ODE</strong>:</p>
<p><span class="math display">\[
\dot{x} = -15 \, x
\]</span></p>
<div class="columns">
<div class="column">
<div class="fragment">
<div id="208f2f86" class="cell" data-execution_count="20">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/cell-21-output-1.png" width="757" height="421"></p>
</figure>
</div>
</div>
</div>
</div>
</div><div class="column">
<ul>
<li class="fragment">Don‚Äôt be fooled by the seemingly simple ODE!</li>
<li class="fragment">With a large step size (e.g., <span class="math inline">\(\Delta t = 1/4\)</span>), the Euler method produces wildly oscillating and diverging results.</li>
<li class="fragment">We need different numerical methods designed to handle stiffness effectively.</li>
</ul>
</div></div>
<div class="fragment fade-left">
<div title="Tip">
<div class="callout callout-tip callout-titled callout-style-simple">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Don‚Äôt use Euler scheme.</p>
</div>
</div>
</div>
</div>
</div>
<div class="footer">
<p>The example was taken from Wikipedia. Check out the full article on <a href="https://en.wikipedia.org/wiki/Stiff_equation">Stiff equations</a> for more details!</p>
</div>
</section>
<section id="many-ways-to-integrate-odes" class="slide level2" data-transition="fade-in slide-out">
<h2>Many ways to integrate ODEs</h2>
<p>When integrating ODEs, different schemes are suited for different regimes:</p>
<div class="fragment fade-left">
<h3 id="rungekutta-rk45">üßÆ Runge‚ÄìKutta (RK45)</h3>
<ul>
<li class="fragment"><strong>Explicit</strong> ‚Üí fast, accurate for <em>non-stiff</em> systems<br>
</li>
<li class="fragment">Works best when all time scales are similar<br>
</li>
</ul>
</div>
<div class="fragment fade-left">
<h3 id="bdf-backward-differentiation-formula">‚öôÔ∏è BDF (Backward Differentiation Formula)</h3>
<ul>
<li class="fragment"><strong>Implicit</strong> ‚Üí robust for <em>stiff</em> systems<br>
</li>
<li class="fragment">Ideal for chemical kinetics, heat transfer, adsorption dynamics</li>
</ul>
</div>
<div class="fragment fade-left">
<h3 id="lsoda">üîÄ LSODA</h3>
<ul>
<li class="fragment"><strong>Hybrid</strong> ‚Üí automatically switches between explicit (Adams) and implicit (BDF)<br>
</li>
<li class="fragment">Detects stiffness during runtime<br>
</li>
<li class="fragment">Excellent default if stiffness is uncertain</li>
</ul>
</div>
</section></section>
<section>
<section id="solving-odes-with-python" class="title-slide slide level1 center">
<h1><i class="fa-brands fa-python" aria-label="python"></i> Solving ODEs with Python</h1>
<blockquote>
<p>This section will explain how python can be easily used to solve any ordinary differential equations system, regardless of its complexity.</p>
</blockquote>
</section>
<section id="solving-odes-with-python-1" class="slide level2">
<h2>Solving ODEs with Python</h2>
<p>Python offers several libraries for solving ODEs, with SciPy being one of the most popular.</p>
<p>The <code>scipy.integrate</code> module provides the function <code>solve_ivp</code> that can be used to numerically solve ODEs in the Initial Value Problem formulation.</p>
<div class="fragment fade-left">
<blockquote>
<p>Let‚Äôs take a look at SciPy‚Äôs <code>solve_ivp</code>!</p>
</blockquote>
<p><img data-src="assets/scipy_logo.svg" alt="Scipy_logo" width="250"></p>
</div>
<div class="footer">
<p>Check out <a href="https://scipy.org/">SciPy</a> for more details.</p>
</div>
</section>
<section id="scipy-and-solve_ivp" class="slide level2 scrollable">
<h2>Scipy and <code>solve_ivp</code></h2>
<p>The <code>solve_ivp</code> function can handle both stiff and non-stiff systems and offers various integration methods.</p>
<p>Solving an ODE with <code>solve_ivp</code> typically involves the following steps:</p>
<ol type="1">
<li class="fragment"><p><strong>Define the IVP problem</strong>: Define the ODE system and initial conditions.</p></li>
<li class="fragment"><p><strong>Implement the ODE system</strong>: Write a function that computes and returns the derivatives.</p></li>
<li class="fragment"><p><strong>Setup and call <code>solve_ivp</code></strong>: Specify the time span, initial conditions, and method.</p></li>
<li class="fragment"><p><strong>Extract and analyze the results</strong>.</p></li>
</ol>
<div class="fragment fade-left">
<blockquote>
<p><code>import scipy.integrate as spi</code></p>
</blockquote>
<blockquote>
<p><code>from scipy.integrate import solve_ivp</code></p>
</blockquote>
<p>You can follow me along in the <a href="https://github.com/MattiaGalantii/PPT_2025_Introduction/blob/master/lecture_exercises_students/population_balance_students.ipynb">population_balance_students.ipynb</a> notebook!</p>
</div>
</section>
<section id="define-the-ivp-problem" class="slide level2">
<h2>1. Define the IVP problem</h2>
<p>Consider a population of rabbits <em>N</em>.</p>
<p>The population grows at a rate proportional to its current size, and also proportional to the available resources, which decrease as the population increases. This can be modeled with the following ODE:</p>
<div class="fragment">
<p><span class="math display">\[
\frac{dN}{dt} = rN\left(1 - \frac{N}{K}\right)
\]</span></p>
</div>
<div class="fragment">
<p>where:</p>
<ul>
<li class="fragment"><em>r</em> is the intrinsic growth rate,</li>
<li class="fragment"><em>K</em> is the carrying capacity of the environment.</li>
<li class="fragment"><span class="math inline">\(N(0)\)</span> = <span class="math inline">\(N_0\)</span> is the initial population size.</li>
</ul>
</div>
</section>
<section id="implement-the-ode-system" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">2. Implement the ODE system</h2>
<p>We can implement the ODE system in Python as follows:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31" data-code-line-numbers="1-3|5-7"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb31-1" class="hljs-ln-code"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb31-2" class="hljs-ln-code"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb31-3" class="hljs-ln-code"><a></a><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</span>
<span id="cb31-4" class="hljs-ln-code"><a></a></span>
<span id="cb31-5" class="hljs-ln-code"><a></a><span class="kw">def</span> rabbit_population(t, y, r, K):</span>
<span id="cb31-6" class="hljs-ln-code"><a></a>    dydt <span class="op">=</span> r <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y <span class="op">/</span> K)</span>
<span id="cb31-7" class="hljs-ln-code"><a></a>    <span class="cf">return</span> dydt</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="setup-solve_ivp" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">3. Setup <code>solve_ivp</code></h2>
<p>Let‚Äôs set up the parameters and initial conditions for our simulation:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32" data-code-line-numbers="|9-10|11-14|"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb32-1" class="hljs-ln-code"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb32-2" class="hljs-ln-code"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb32-3" class="hljs-ln-code"><a></a><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</span>
<span id="cb32-4" class="hljs-ln-code"><a></a></span>
<span id="cb32-5" class="hljs-ln-code"><a></a><span class="kw">def</span> rabbit_population(t, y, r, K):</span>
<span id="cb32-6" class="hljs-ln-code"><a></a>    dydt <span class="op">=</span> r <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y <span class="op">/</span> K)</span>
<span id="cb32-7" class="hljs-ln-code"><a></a>    <span class="cf">return</span> dydt</span>
<span id="cb32-8" class="hljs-ln-code"><a></a></span>
<span id="cb32-9" class="hljs-ln-code"><a></a>r <span class="op">=</span> <span class="fl">0.1</span>  <span class="co"># growth rate [1/s]</span></span>
<span id="cb32-10" class="hljs-ln-code"><a></a>K <span class="op">=</span> <span class="dv">100</span>  <span class="co"># carrying capacity [individuals]</span></span>
<span id="cb32-11" class="hljs-ln-code"><a></a>y0 <span class="op">=</span> [<span class="dv">10</span>]  <span class="co"># initial population [individuals]</span></span>
<span id="cb32-12" class="hljs-ln-code"><a></a>t_span <span class="op">=</span> (<span class="dv">0</span>, <span class="dv">100</span>)  <span class="co"># time span for the simulation [s]</span></span>
<span id="cb32-13" class="hljs-ln-code"><a></a>t_eval <span class="op">=</span> np.linspace(t_span[<span class="dv">0</span>], t_span[<span class="dv">1</span>], <span class="dv">100</span>)</span>
<span id="cb32-14" class="hljs-ln-code"><a></a>method <span class="op">=</span> <span class="st">'RK45'</span>  <span class="co"># integration method</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="call-solve_ivp" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">4. Call <code>solve_ivp</code></h2>
<p>Now we can call the <code>solve_ivp</code> function to solve the ODE:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33" data-code-line-numbers="|1-3|4-6|"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb33-1" class="hljs-ln-code"><a></a>solution <span class="op">=</span> solve_ivp(rabbit_population, </span>
<span id="cb33-2" class="hljs-ln-code"><a></a>                     t_span, </span>
<span id="cb33-3" class="hljs-ln-code"><a></a>                     y0, </span>
<span id="cb33-4" class="hljs-ln-code"><a></a>                     args<span class="op">=</span>(r, K), </span>
<span id="cb33-5" class="hljs-ln-code"><a></a>                     t_eval<span class="op">=</span>t_eval,</span>
<span id="cb33-6" class="hljs-ln-code"><a></a>                     method<span class="op">=</span>method)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="footer">
<p>Doubts about the function arguments? Check the <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html">official documentation</a> for more details.</p>
</div>
</section>
<section id="extract-and-analyze-results" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">5. Extract and analyze results</h2>
<p>Finally, we can plot the results to visualize the rabbit population growth over time:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb34-1" class="hljs-ln-code"><a></a>solution <span class="op">=</span> solve_ivp(rabbit_population, </span>
<span id="cb34-2" class="hljs-ln-code"><a></a>                     t_span, </span>
<span id="cb34-3" class="hljs-ln-code"><a></a>                     y0, </span>
<span id="cb34-4" class="hljs-ln-code"><a></a>                     args<span class="op">=</span>(r, K), </span>
<span id="cb34-5" class="hljs-ln-code"><a></a>                     t_eval<span class="op">=</span>t_eval,</span>
<span id="cb34-6" class="hljs-ln-code"><a></a>                     method<span class="op">=</span>method)</span>
<span id="cb34-7" class="hljs-ln-code"><a></a></span>
<span id="cb34-8" class="hljs-ln-code"><a></a></span>
<span id="cb34-9" class="hljs-ln-code"><a></a>sol_time <span class="op">=</span> solution.t</span>
<span id="cb34-10" class="hljs-ln-code"><a></a>sol_y <span class="op">=</span> solution.y[<span class="dv">0</span>]</span>
<span id="cb34-11" class="hljs-ln-code"><a></a>    </span>
<span id="cb34-12" class="hljs-ln-code"><a></a>plt.plot(sol_time, sol_y, label<span class="op">=</span><span class="st">'Rabbit Population'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb34-13" class="hljs-ln-code"><a></a>plt.plot(<span class="dv">0</span>, y0, <span class="st">'ro'</span>, label<span class="op">=</span><span class="st">'Initial Population'</span>)</span>
<span id="cb34-14" class="hljs-ln-code"><a></a>plt.hlines(K, colors<span class="op">=</span><span class="st">'g'</span>, linestyles<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Carrying Capacity (K)'</span>, xmin<span class="op">=</span>t_span[<span class="dv">0</span>], xmax<span class="op">=</span>t_span[<span class="dv">1</span>])</span>
<span id="cb34-15" class="hljs-ln-code"><a></a>plt.title(<span class="st">'Rabbit Population Growth Over Time'</span>)</span>
<span id="cb34-16" class="hljs-ln-code"><a></a>plt.xlabel(<span class="st">'Time'</span>)</span>
<span id="cb34-17" class="hljs-ln-code"><a></a>plt.ylabel(<span class="st">'Population'</span>)</span>
<span id="cb34-18" class="hljs-ln-code"><a></a>plt.legend()</span>
<span id="cb34-19" class="hljs-ln-code"><a></a>plt.grid()</span>
<span id="cb34-20" class="hljs-ln-code"><a></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="footer">
<p>Doubts about the function arguments? Check the <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html">official documentation</a> for more details.</p>
</div>
</section>
<section id="results" class="slide level2">
<h2>Results</h2>
<div id="2ceeb2f3" class="cell" data-execution_count="21">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/cell-22-output-1.png" width="821" height="533"></p>
</figure>
</div>
</div>
</div>
<ul>
<li class="fragment">Maybe not very realistic for rabbits, but still a good example of how to use <code>solve_ivp</code>!</li>
</ul>
</section>
<section id="now-you-try" class="slide level2">
<h2>Now you try!</h2>
<ul>
<li class="fragment">Open the <a href="https://github.com/MattiaGalantii/PPT_2025_Introduction/blob/master/lecture_exercises_students/population_balance_students.ipynb">population_balance_students.ipynb</a> and go to the section <strong>‚ÄúYour turn!‚Äù</strong>.</li>
<li class="fragment">Play around with different parameters for <em>r</em>, <em>K</em>, and <em>N‚ÇÄ</em>.</li>
<li class="fragment">Modify the code such that you solve the ODE for a <strong>different initial conditions</strong> and plot the results on the same graph.</li>
<li class="fragment">Try to remove <code>t_eval=t_eval</code> from the <code>solve_ivp</code> function and see what happens to the output plot. Do you notice any difference?</li>
</ul>
<div class="fragment">
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>To account for multiple initial conditions, don‚Äôt copy and paste the <code>solve_ivp</code> function multiple times. Instead, use the concept of <strong>loops</strong> that you learned in the previous sections!</p>
</div>
</div>
</div>
</div>
</section>
<section id="different-initial-conditions-example" class="slide level2">
<h2>Different initial conditions example</h2>
<p>Here‚Äôs an example of how to solve the ODE for different initial conditions and plot the results on the same graph:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35" data-code-line-numbers="|12|16-25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb35-2"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb35-3"><a></a><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</span>
<span id="cb35-4"><a></a></span>
<span id="cb35-5"><a></a><span class="kw">def</span> rabbit_population(t, y, r, K):</span>
<span id="cb35-6"><a></a>    dydt <span class="op">=</span> r <span class="op">*</span> y <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> y <span class="op">/</span> K)</span>
<span id="cb35-7"><a></a>    <span class="cf">return</span> dydt</span>
<span id="cb35-8"><a></a></span>
<span id="cb35-9"><a></a><span class="co"># Parameters</span></span>
<span id="cb35-10"><a></a>r <span class="op">=</span> <span class="fl">0.1</span>  <span class="co"># growth rate</span></span>
<span id="cb35-11"><a></a>K <span class="op">=</span> <span class="dv">100</span>  <span class="co"># carrying capacity</span></span>
<span id="cb35-12"><a></a>y0s <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">80</span>, <span class="dv">120</span>, <span class="dv">150</span>]  <span class="co"># initial population</span></span>
<span id="cb35-13"><a></a>t_span <span class="op">=</span> (<span class="dv">0</span>, <span class="dv">100</span>)  <span class="co"># time span for the simulation</span></span>
<span id="cb35-14"><a></a>t_eval <span class="op">=</span> np.linspace(t_span[<span class="dv">0</span>], t_span[<span class="dv">1</span>], <span class="dv">100</span>)</span>
<span id="cb35-15"><a></a></span>
<span id="cb35-16"><a></a><span class="cf">for</span> N0 <span class="kw">in</span> y0s:</span>
<span id="cb35-17"><a></a>    solution <span class="op">=</span> solve_ivp(rabbit_population, </span>
<span id="cb35-18"><a></a>                         t_span, </span>
<span id="cb35-19"><a></a>                         [N0], </span>
<span id="cb35-20"><a></a>                         args<span class="op">=</span>(r, K), </span>
<span id="cb35-21"><a></a>                         t_eval<span class="op">=</span>t_eval)</span>
<span id="cb35-22"><a></a></span>
<span id="cb35-23"><a></a>    <span class="co"># Plot results</span></span>
<span id="cb35-24"><a></a>    plt.plot(solution.t, solution.y[<span class="dv">0</span>], label<span class="op">=</span><span class="ss">f'Rabbit Population (N0=</span><span class="sc">{</span>N0<span class="sc">}</span><span class="ss">)'</span>, linewidth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb35-25"><a></a>    plt.plot(<span class="dv">0</span>, N0, <span class="st">'ro'</span>, label<span class="op">=</span><span class="st">'Initial Population'</span>)</span>
<span id="cb35-26"><a></a>    </span>
<span id="cb35-27"><a></a>plt.hlines(K, colors<span class="op">=</span><span class="st">'g'</span>, linestyles<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'Carrying Capacity (K)'</span>, xmin<span class="op">=</span>t_span[<span class="dv">0</span>], xmax<span class="op">=</span>t_span[<span class="dv">1</span>])</span>
<span id="cb35-28"><a></a>plt.title(<span class="st">'Rabbit Population Growth Over Time'</span>)</span>
<span id="cb35-29"><a></a>plt.xlabel(<span class="st">'Time'</span>)</span>
<span id="cb35-30"><a></a>plt.ylabel(<span class="st">'Population'</span>)</span>
<span id="cb35-31"><a></a>plt.grid()</span>
<span id="cb35-32"><a></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="profiles-and-phase-space" class="slide level2">
<h2>Profiles and Phase Space</h2>
<div class="columns">
<div class="column">
<div id="130d39df" class="cell" data-dpi="120" data-execution_count="22">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/cell-23-output-1.png" width="749" height="608"></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<div id="f3dd6bab" class="cell" data-dpi="120" data-execution_count="23">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/cell-24-output-1.png" width="753" height="616"></p>
</figure>
</div>
</div>
</div>
</div></div>
<div class="fragment">
<p>Let‚Äôs proceed to something more complex in the next section!</p>
</div>
</section>
<section id="solve-for-systems-of-odes" class="slide level2 scrollable">
<h2>Solve for systems of ODEs</h2>
<p>Now that we have a basic understanding of how to use <code>solve_ivp</code>, let‚Äôs tackle a more complex ODE system, containing more that one equation.</p>
<p>Recall:</p>
<ol type="1">
<li class="fragment"><p><strong>Define the IVP problem</strong>: Define the ODE system and initial conditions.</p></li>
<li class="fragment"><p><strong>Implement the ODE system</strong>: Write a function that computes and returns the derivatives.</p></li>
<li class="fragment"><p><strong>Setup and call <code>solve_ivp</code></strong>: Specify the time span, initial conditions, and method.</p></li>
<li class="fragment"><p><strong>Extract and analyze the results</strong></p></li>
</ol>
<div class="fragment">
<p>You can follow me along by opening the <a href="https://github.com/MattiaGalantii/PPT_2025_Introduction/blob/master/lecture_exercises_students/Lorentz_system_students.ipynb">lorenz_system_students.ipynb</a> notebook!</p>
</div>
</section>
<section id="a-strange-example-lorenz-system" class="slide level2">
<h2>1. A <em>‚Äústrange‚Äù</em> example: Lorenz system</h2>
<p>Edward Lorentz (1963) wanted to model atmospheric convection, with variables <span class="math inline">\(x(t)\)</span>, <span class="math inline">\(y(t)\)</span>, and <span class="math inline">\(z(t)\)</span> related to fluid flow and temperature.</p>
<div class="{fragment}">
<p>He ended up with a simplified model, a set of three <em>first-order, coupled, nonlinear</em> differential equations:</p>
<p><span class="math display">\[
\begin{align*}
\dot{x} &amp;= \Pr (y - x) \\
\dot{y} &amp;= x (\text{Ra} - z) - y \\
\dot{z} &amp;= xy - \beta z
\end{align*}
\]</span></p>
<p>The parameters <span class="math inline">\(\Pr\)</span> (Prandtl), Ra (Rayleigh), and <span class="math inline">\(\beta\)</span> are constants that depend on the physical properties of the fluid and the conditions of the system.</p>
</div>
<div class="footer">
<p>The story behind the Lorenz system is quite fascinating, I recommend reading about it! Check-out this Veritasium video: <a href="https://www.youtube.com/watch?v=fDek6cYijxI&amp;t=416s">Chaos: The Science of the Butterfly Effect | Veritasium</a></p>
</div>
</section>
<section id="implementing-the-lorenz-system-in-python" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">2. Implementing the Lorenz system in Python</h2>
<p>Let‚Äôs implement the Lorenz system using <code>solve_ivp</code>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb36" data-code-line-numbers="|5|6|7-9|10|"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb36-1" class="hljs-ln-code"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb36-2" class="hljs-ln-code"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb36-3" class="hljs-ln-code"><a></a><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</span>
<span id="cb36-4" class="hljs-ln-code"><a></a></span>
<span id="cb36-5" class="hljs-ln-code"><a></a><span class="kw">def</span> lorenz_system(t, y, Pr, Ra, beta):</span>
<span id="cb36-6" class="hljs-ln-code"><a></a>    x, y, z <span class="op">=</span> y</span>
<span id="cb36-7" class="hljs-ln-code"><a></a>    dxdt <span class="op">=</span> Pr <span class="op">*</span> (y <span class="op">-</span> x)</span>
<span id="cb36-8" class="hljs-ln-code"><a></a>    dydt <span class="op">=</span> x <span class="op">*</span> (Ra <span class="op">-</span> z) <span class="op">-</span> y</span>
<span id="cb36-9" class="hljs-ln-code"><a></a>    dzdt <span class="op">=</span> x <span class="op">*</span> y <span class="op">-</span> beta <span class="op">*</span> z</span>
<span id="cb36-10" class="hljs-ln-code"><a></a>    <span class="cf">return</span> [dxdt, dydt, dzdt]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="fragment">
<p>Let‚Äôs consider two initial conditions that are very close to each other: <span class="math display">\[\mathbf{y_0} = [1.0, 1.0, 1.0]\]</span> <span class="math display">\[\mathbf{y_0'} = [1.0 + \varepsilon, 1.0, 1.0]\]</span> with <span class="math inline">\(\varepsilon = 10^{-6}\)</span>.</p>
</div>
</section>
<section id="implementing-the-lorenz-system-in-python-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">2. Implementing the Lorenz system in Python</h2>
<p>Let‚Äôs implement the Lorenz system using <code>solve_ivp</code>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb37" data-code-line-numbers="|"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb37-1" class="hljs-ln-code"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb37-2" class="hljs-ln-code"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb37-3" class="hljs-ln-code"><a></a><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</span>
<span id="cb37-4" class="hljs-ln-code"><a></a></span>
<span id="cb37-5" class="hljs-ln-code"><a></a><span class="kw">def</span> lorenz_system(t, y, Pr, Ra, beta):</span>
<span id="cb37-6" class="hljs-ln-code"><a></a>    x, y, z <span class="op">=</span> y</span>
<span id="cb37-7" class="hljs-ln-code"><a></a>    dxdt <span class="op">=</span> Pr <span class="op">*</span> (y <span class="op">-</span> x)</span>
<span id="cb37-8" class="hljs-ln-code"><a></a>    dydt <span class="op">=</span> x <span class="op">*</span> (Ra <span class="op">-</span> z) <span class="op">-</span> y</span>
<span id="cb37-9" class="hljs-ln-code"><a></a>    dzdt <span class="op">=</span> x <span class="op">*</span> y <span class="op">-</span> beta <span class="op">*</span> z</span>
<span id="cb37-10" class="hljs-ln-code"><a></a>    <span class="cf">return</span> [dxdt, dydt, dzdt]</span>
<span id="cb37-11" class="hljs-ln-code"><a></a></span>
<span id="cb37-12" class="hljs-ln-code"><a></a>Pr <span class="op">=</span> <span class="fl">10.0</span></span>
<span id="cb37-13" class="hljs-ln-code"><a></a>Ra  <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb37-14" class="hljs-ln-code"><a></a>beta  <span class="op">=</span> <span class="fl">8.0</span> <span class="op">/</span> <span class="fl">3.0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="setup-the-solver" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">3. Setup the solver</h2>
<p>Let‚Äôs implement the Lorenz system using <code>solve_ivp</code>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb38" data-code-line-numbers="|16-18|20-22"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb38-1" class="hljs-ln-code"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb38-2" class="hljs-ln-code"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb38-3" class="hljs-ln-code"><a></a><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</span>
<span id="cb38-4" class="hljs-ln-code"><a></a></span>
<span id="cb38-5" class="hljs-ln-code"><a></a><span class="kw">def</span> lorenz_system(t, y, Pr, Ra, beta):</span>
<span id="cb38-6" class="hljs-ln-code"><a></a>    x, y, z <span class="op">=</span> y</span>
<span id="cb38-7" class="hljs-ln-code"><a></a>    dxdt <span class="op">=</span> Pr <span class="op">*</span> (y <span class="op">-</span> x)</span>
<span id="cb38-8" class="hljs-ln-code"><a></a>    dydt <span class="op">=</span> x <span class="op">*</span> (Ra <span class="op">-</span> z) <span class="op">-</span> y</span>
<span id="cb38-9" class="hljs-ln-code"><a></a>    dzdt <span class="op">=</span> x <span class="op">*</span> y <span class="op">-</span> beta <span class="op">*</span> z</span>
<span id="cb38-10" class="hljs-ln-code"><a></a>    <span class="cf">return</span> [dxdt, dydt, dzdt]</span>
<span id="cb38-11" class="hljs-ln-code"><a></a></span>
<span id="cb38-12" class="hljs-ln-code"><a></a>Pr <span class="op">=</span> <span class="fl">10.0</span></span>
<span id="cb38-13" class="hljs-ln-code"><a></a>Ra  <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb38-14" class="hljs-ln-code"><a></a>beta  <span class="op">=</span> <span class="fl">8.0</span> <span class="op">/</span> <span class="fl">3.0</span></span>
<span id="cb38-15" class="hljs-ln-code"><a></a></span>
<span id="cb38-16" class="hljs-ln-code"><a></a>y0   <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb38-17" class="hljs-ln-code"><a></a>eps  <span class="op">=</span> <span class="fl">1e-6</span></span>
<span id="cb38-18" class="hljs-ln-code"><a></a>y0_2 <span class="op">=</span> np.array([<span class="fl">1.0</span> <span class="op">+</span> eps, <span class="fl">1.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb38-19" class="hljs-ln-code"><a></a></span>
<span id="cb38-20" class="hljs-ln-code"><a></a>t_end <span class="op">=</span> <span class="fl">50.0</span></span>
<span id="cb38-21" class="hljs-ln-code"><a></a>t_span <span class="op">=</span> (<span class="fl">0.0</span>, t_end)</span>
<span id="cb38-22" class="hljs-ln-code"><a></a>t_eval <span class="op">=</span> np.linspace(t_span[<span class="dv">0</span>], t_span[<span class="dv">1</span>], <span class="dv">10000</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="solve-the-system-and-extract-results" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">4. Solve the system and extract results</h2>
<p>Let‚Äôs implement the Lorenz system using <code>solve_ivp</code>.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39" data-code-line-numbers="24|26-27|29-31"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb39-1" class="hljs-ln-code"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb39-2" class="hljs-ln-code"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb39-3" class="hljs-ln-code"><a></a><span class="im">from</span> scipy.integrate <span class="im">import</span> solve_ivp</span>
<span id="cb39-4" class="hljs-ln-code"><a></a></span>
<span id="cb39-5" class="hljs-ln-code"><a></a><span class="kw">def</span> lorenz_system(t, y, Pr, Ra, beta):</span>
<span id="cb39-6" class="hljs-ln-code"><a></a>    x, y, z <span class="op">=</span> y</span>
<span id="cb39-7" class="hljs-ln-code"><a></a>    dxdt <span class="op">=</span> Pr <span class="op">*</span> (y <span class="op">-</span> x)</span>
<span id="cb39-8" class="hljs-ln-code"><a></a>    dydt <span class="op">=</span> x <span class="op">*</span> (Ra <span class="op">-</span> z) <span class="op">-</span> y</span>
<span id="cb39-9" class="hljs-ln-code"><a></a>    dzdt <span class="op">=</span> x <span class="op">*</span> y <span class="op">-</span> beta <span class="op">*</span> z</span>
<span id="cb39-10" class="hljs-ln-code"><a></a>    <span class="cf">return</span> [dxdt, dydt, dzdt]</span>
<span id="cb39-11" class="hljs-ln-code"><a></a></span>
<span id="cb39-12" class="hljs-ln-code"><a></a>Pr <span class="op">=</span> <span class="fl">10.0</span></span>
<span id="cb39-13" class="hljs-ln-code"><a></a>Ra  <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb39-14" class="hljs-ln-code"><a></a>beta  <span class="op">=</span> <span class="fl">8.0</span> <span class="op">/</span> <span class="fl">3.0</span></span>
<span id="cb39-15" class="hljs-ln-code"><a></a></span>
<span id="cb39-16" class="hljs-ln-code"><a></a>y0   <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb39-17" class="hljs-ln-code"><a></a>eps  <span class="op">=</span> <span class="fl">1e-6</span></span>
<span id="cb39-18" class="hljs-ln-code"><a></a>y0_2 <span class="op">=</span> np.array([<span class="fl">1.0</span> <span class="op">+</span> eps, <span class="fl">1.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb39-19" class="hljs-ln-code"><a></a></span>
<span id="cb39-20" class="hljs-ln-code"><a></a>t_end <span class="op">=</span> <span class="fl">50.0</span></span>
<span id="cb39-21" class="hljs-ln-code"><a></a>t_span <span class="op">=</span> (<span class="fl">0.0</span>, t_end)</span>
<span id="cb39-22" class="hljs-ln-code"><a></a>t_eval <span class="op">=</span> np.linspace(t_span[<span class="dv">0</span>], t_span[<span class="dv">1</span>], <span class="dv">10000</span>)</span>
<span id="cb39-23" class="hljs-ln-code"><a></a></span>
<span id="cb39-24" class="hljs-ln-code"><a></a>method <span class="op">=</span> <span class="st">"RK45"</span>          </span>
<span id="cb39-25" class="hljs-ln-code"><a></a></span>
<span id="cb39-26" class="hljs-ln-code"><a></a>sol1 <span class="op">=</span> solve_ivp(lorenz_system, t_span, y0,   args<span class="op">=</span>(Pr, Ra, beta), t_eval<span class="op">=</span>t_eval, method<span class="op">=</span>method, rtol<span class="op">=</span><span class="fl">1e-9</span>, atol<span class="op">=</span><span class="fl">1e-12</span>)</span>
<span id="cb39-27" class="hljs-ln-code"><a></a>sol2 <span class="op">=</span> solve_ivp(lorenz_system, t_span, y0_2, args<span class="op">=</span>(Pr, Ra, beta), t_eval<span class="op">=</span>t_eval, method<span class="op">=</span>method, rtol<span class="op">=</span><span class="fl">1e-9</span>, atol<span class="op">=</span><span class="fl">1e-12</span>)</span>
<span id="cb39-28" class="hljs-ln-code"><a></a></span>
<span id="cb39-29" class="hljs-ln-code"><a></a>t <span class="op">=</span> sol1.t</span>
<span id="cb39-30" class="hljs-ln-code"><a></a>X1, Y1, Z1 <span class="op">=</span> sol1.y</span>
<span id="cb39-31" class="hljs-ln-code"><a></a>X2, Y2, Z2 <span class="op">=</span> sol2.y</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="visualize-the-results" class="slide level2">
<h2>5. Visualize the results</h2>
<p>Visualizing the time evolution of the Lorenz system can reveal its peculiar behavior..</p>
<p>It‚Äôs time for you to complete the code and generate the plots! <a href="https://github.com/MattiaGalantii/PPT_2025_Introduction/blob/master/lecture_exercises_students/Lorentz_system_students.ipynb">Go to the ‚Äúexercise‚Äù cell</a> and:</p>
<ul>
<li class="fragment">Create a 3x1 subplot figure.</li>
<li class="fragment">Plot <span class="math inline">\(x(t)\)</span>, <span class="math inline">\(y(t)\)</span>, and <span class="math inline">\(z(t)\)</span> for both initial conditions.</li>
<li class="fragment">Create a 1x3 subplot figure.</li>
<li class="fragment">Plot the phase portraits: <span class="math inline">\(x(t)\)</span> vs <span class="math inline">\(z(t)\)</span>, <span class="math inline">\(x(t)\)</span> vs <span class="math inline">\(y(t)\)</span>, and <span class="math inline">\(y(t)\)</span> vs <span class="math inline">\(z(t)\)</span> for both initial conditions. (Note: x-axis vs y-axis)</li>
<li class="fragment">Increase slowly Rayleigh number <code>Ra</code> (1 - 25) and observe how the system‚Äôs behavior changes!</li>
</ul>
<div class="fragment">
<p>Minimal starter code is provided below:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a></a>fig_3_1, axes_3_1 <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">10</span>), sharex<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb40-2"><a></a>colors <span class="op">=</span> {<span class="st">"x"</span>:<span class="st">"tab:blue"</span>, <span class="st">"y"</span>:<span class="st">"tab:orange"</span>, <span class="st">"z"</span>:<span class="st">"tab:green"</span>}</span>
<span id="cb40-3"><a></a>axes[<span class="dv">0</span>].plot(t, X1, color<span class="op">=</span>colors[<span class="st">"x"</span>])</span>
<span id="cb40-4"><a></a></span>
<span id="cb40-5"><a></a>fig_3_1, axes_1_3 <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">12</span>, <span class="dv">5</span>), sharex<span class="op">=</span><span class="va">False</span>, sharey<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb40-6"><a></a>axes_1_3[<span class="dv">0</span>].plot(X1, Z1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="time-series-solutions" class="slide level2">
<h2>Time series solutions</h2>
<video id="video_shortcode_videojs_video1" width="1000" class="video-js vjs-default-skin " controls="" preload="auto" data-setup="{}" title=""><source src="assets/lorenz_rho_sweep.mp4"></video>
</section>
<section id="phase-space-plots" class="slide level2">
<h2>Phase space plots</h2>
<video id="video_shortcode_videojs_video2" width="1500" class="video-js vjs-default-skin " controls="" preload="auto" data-setup="{}" title=""><source src="assets/lorenz_phase_rho_sweep.mp4"></video>
<div class="footer">
<p>Want to know more? I highly recommend checking out the following resources:</p>
<p><a href="https://link.springer.com/chapter/10.1007/978-3-0348-0697-8_1">The Lorenz Attractor, a Paradigm for Chaos</a></p>
<p><a href="https://www.youtube.com/watch?v=fDek6cYijxI">Chaos: The Science of the Butterfly Effect | Veritasium</a></p>
<p><a href="https://www.youtube.com/watch?v=uzJXeluCKMs">Chaos Theory: The Language of (in)stability | Gonkee</a></p>
<p><a href="https://www.youtube.com/watch?v=idpOunnpKTo">Are there other Chaotic Attractors?</a></p>
</div>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<p>I might have convinced you that <code>solve_ivp</code> is a powerful tool to solve ODEs in Python, even for complex systems.</p>
<div class="columns">
<div class="column">
<p>You should now be able to:</p>
<ul>
<li class="fragment">Define and implement systems of ODEs in Python.</li>
<li class="fragment">Use <code>solve_ivp</code> to solve these systems numerically.</li>
<li class="fragment">Visualize and analyze the results effectively.</li>
</ul>
</div><div class="column">
<div class="fragment">
<p><img data-src="https://media1.tenor.com/m/3yPBPC_dwe8AAAAd/leonardo-dicaprio-clapping.gif" style="width:40.0%"></p>
</div>
</div></div>
<div class="fragment">
<p>Only one thing is missing: what if we don‚Äôt know the <strong>parameters</strong> of the system? How can we estimate them from data?</p>
</div>
</section></section>
<section>
<section id="introduction-to-model-fitting" class="title-slide slide level1 center">
<h1><i class="fa-solid fa-chart-line" aria-label="chart-line"></i> Introduction to Model Fitting</h1>
<blockquote>
<p><em>Fitting mathematical models to experimental data using Python</em></p>
</blockquote>
</section>
<section id="why-model-fitting" class="slide level2">
<h2>Why Model Fitting?</h2>
<ul>
<li>In many scientific and engineering applications, we have experimental data that we want to describe using mathematical models.</li>
<li>Model fitting allows us to estimate the <strong>parameters</strong> of these models so that they best represent the observed data.</li>
<li>This is crucial for making predictions, understanding underlying processes, and optimizing systems.</li>
</ul>

<img data-src="assets/meme_models.jpeg" width="600" class="r-stretch"></section>
<section id="python-libraries-for-model-fitting" class="slide level2">
<h2>Python Libraries for Model Fitting</h2>
<p>There are many libraries in Python that facilitate model fitting.</p>
<p>For this introduction, we will focus on Scipy‚Äôs <code>curve_fit</code> and <code>least_squares</code> function from the <code>optimize</code> module.</p>
<p>When to use <code>curve_fit</code>:</p>
<ul>
<li class="fragment">One experiment at a time</li>
<li class="fragment">Fast and easy fitting</li>
</ul>
<p>When to use <code>least_squares</code>:</p>
<ul>
<li class="fragment">You have multiple experiments to fit simultaneously</li>
<li class="fragment">You want more control over the optimization process</li>
</ul>
<div class="footer">
<p>Check the <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.curve_fit.html">official documentation</a> for more details.</p>
</div>
</section>
<section id="example-fitting-a-non-linear-model" class="slide level2">
<h2>Example: Fitting a Non-Linear Model</h2>
<p>Let‚Äôs consider an example where we have experimental data that follows a non-linear relationship, such as an exponential decay model. <span class="math display">\[
y(x) = e^{-\lambda x}\,\sin(\omega x)
\]</span></p>
<p>We‚Äôll recover the <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\omega\)</span> parameters of a <strong>damped sine</strong> model from noisy synthetic data.</p>
<p>You can open this example in a Jupyter notebook and follow me: <a href="https://github.com/MattiaGalantii/PPT_2025_Introduction/blob/master/lecture_exercises_students/model_fitting_students.ipynb">model_fitting_students.ipynb</a>.</p>
</section>
<section id="generating-synthetic-data" class="slide level2">
<h2>Generating Synthetic Data</h2>
<p>First , we generate synthetic data based on known parameters and add some noise to simulate experimental measurements.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb41-2"><a></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb41-3"><a></a><span class="im">from</span> scipy.optimize <span class="im">import</span> curve_fit</span>
<span id="cb41-4"><a></a></span>
<span id="cb41-5"><a></a>rng <span class="op">=</span> np.random.default_rng(<span class="dv">7</span>)</span>
<span id="cb41-6"><a></a>lam_true, omega_true <span class="op">=</span> <span class="fl">0.5</span>, np.pi</span>
<span id="cb41-7"><a></a>t_exp <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">300</span>)  </span>
<span id="cb41-8"><a></a>y_true <span class="op">=</span> np.exp(<span class="op">-</span>lam_true <span class="op">*</span> t_exp) <span class="op">*</span> np.sin(omega_true <span class="op">*</span> t_exp)  </span>
<span id="cb41-9"><a></a>sigma <span class="op">=</span> <span class="fl">0.03</span>  </span>
<span id="cb41-10"><a></a>y_exp <span class="op">=</span> y_true <span class="op">+</span> rng.normal(<span class="dv">0</span>, sigma, size<span class="op">=</span>t_exp.size)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="710c3152" class="cell" data-execution_count="24">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/cell-25-output-1.png" width="823" height="376"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fitting-with-least_squares" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Fitting with <code>least_squares</code>:</h2>
<h3 id="defining-the-model-and-residuals-function">Defining the Model and Residuals Function</h3>
<p>To fit the model using <code>least_squares</code>, we first need to define the model function and the residuals function,</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb42-1" class="hljs-ln-code"><a></a><span class="kw">def</span> damped_sine(t, lam, omega):</span>
<span id="cb42-2" class="hljs-ln-code"><a></a>    <span class="cf">return</span> np.exp(<span class="op">-</span>lam <span class="op">*</span> t) <span class="op">*</span> np.sin(omega <span class="op">*</span> t)</span>
<span id="cb42-3" class="hljs-ln-code"><a></a></span>
<span id="cb42-4" class="hljs-ln-code"><a></a><span class="kw">def</span> residuals(x_to_optimize, t_exp, y_exp, sigma<span class="op">=</span><span class="fl">0.03</span>):</span>
<span id="cb42-5" class="hljs-ln-code"><a></a>    lam, omega <span class="op">=</span> x_to_optimize</span>
<span id="cb42-6" class="hljs-ln-code"><a></a>    y_pred <span class="op">=</span> damped_sine(t_exp, lam, omega) </span>
<span id="cb42-7" class="hljs-ln-code"><a></a>    <span class="cf">return</span> (y_exp <span class="op">-</span> y_pred) <span class="op">/</span> sigma  </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="fragment">
<p>The residuals function computes the difference between the observed data and the model predictions, and <em>must</em> take as <em>first argument</em> a single array of parameters to optimize.</p>
<p>Then, additional arguments (like <code>t_exp</code>, <code>y_exp</code>, and <code>sigma</code>) can be passed via the <code>args</code> and <code>kwargs</code> parameters of <code>least_squares</code>.</p>
<p>Why? Look at the signature of <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.least_squares.html">least_squares</a>!</p>
</div>
<div class="footer">
<p>Check the <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.least_squares.html">official documentation</a> for more details.</p>
</div>
</section>
<section id="fitting-with-least_squares-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Fitting with <code>least_squares</code>:</h2>
<h3 id="performing-the-fit">Performing the Fit</h3>
<p>Now, we can use <code>least_squares</code> to estimate the parameters of our model based on the noisy data.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb43" data-code-line-numbers="|9-10|12-16|"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb43-1" class="hljs-ln-code"><a></a><span class="kw">def</span> damped_sine(t, lam, omega):</span>
<span id="cb43-2" class="hljs-ln-code"><a></a>    <span class="cf">return</span> np.exp(<span class="op">-</span>lam <span class="op">*</span> t) <span class="op">*</span> np.sin(omega <span class="op">*</span> t)</span>
<span id="cb43-3" class="hljs-ln-code"><a></a></span>
<span id="cb43-4" class="hljs-ln-code"><a></a><span class="kw">def</span> residuals(x_to_optimize, t_exp, y_exp, sigma<span class="op">=</span><span class="fl">0.03</span>):</span>
<span id="cb43-5" class="hljs-ln-code"><a></a>    lam, omega <span class="op">=</span> x_to_optimize</span>
<span id="cb43-6" class="hljs-ln-code"><a></a>    y_pred <span class="op">=</span> damped_sine(t_exp, lam, omega) </span>
<span id="cb43-7" class="hljs-ln-code"><a></a>    <span class="cf">return</span> (y_exp <span class="op">-</span> y_pred) <span class="op">/</span> sigma   </span>
<span id="cb43-8" class="hljs-ln-code"><a></a></span>
<span id="cb43-9" class="hljs-ln-code"><a></a>p0 <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb43-10" class="hljs-ln-code"><a></a>bounds <span class="op">=</span> (np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>]), np.array([np.inf, <span class="fl">5.0</span>]))</span>
<span id="cb43-11" class="hljs-ln-code"><a></a></span>
<span id="cb43-12" class="hljs-ln-code"><a></a>res <span class="op">=</span> least_squares(residuals, p0, </span>
<span id="cb43-13" class="hljs-ln-code"><a></a>                    bounds<span class="op">=</span>bounds, </span>
<span id="cb43-14" class="hljs-ln-code"><a></a>                    args<span class="op">=</span>(t_exp, y_exp), </span>
<span id="cb43-15" class="hljs-ln-code"><a></a>                    kwargs<span class="op">=</span>{<span class="st">"sigma"</span>: sigma})</span>
<span id="cb43-16" class="hljs-ln-code"><a></a>lam_fit, omega_fit <span class="op">=</span> res.x </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="visualizing-the-results" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">3. Visualizing the Results</h2>
<p>Finally, we can visualize the fitted model against the noisy data and the true model.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb44" data-code-line-numbers="|18-27|"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb44-1" class="hljs-ln-code"><a></a><span class="kw">def</span> damped_sine(t, lam, omega):</span>
<span id="cb44-2" class="hljs-ln-code"><a></a>    <span class="cf">return</span> np.exp(<span class="op">-</span>lam <span class="op">*</span> t) <span class="op">*</span> np.sin(omega <span class="op">*</span> t)</span>
<span id="cb44-3" class="hljs-ln-code"><a></a></span>
<span id="cb44-4" class="hljs-ln-code"><a></a><span class="kw">def</span> residuals(x_to_optimize, t_exp, y_exp, sigma<span class="op">=</span><span class="fl">0.03</span>):</span>
<span id="cb44-5" class="hljs-ln-code"><a></a>    lam, omega <span class="op">=</span> x_to_optimize</span>
<span id="cb44-6" class="hljs-ln-code"><a></a>    y_pred <span class="op">=</span> damped_sine(t_exp, lam, omega) </span>
<span id="cb44-7" class="hljs-ln-code"><a></a>    <span class="cf">return</span> (y_exp <span class="op">-</span> y_pred) <span class="op">/</span> sigma   </span>
<span id="cb44-8" class="hljs-ln-code"><a></a></span>
<span id="cb44-9" class="hljs-ln-code"><a></a>p0 <span class="op">=</span> np.array([<span class="fl">1.0</span>, <span class="fl">1.0</span>])</span>
<span id="cb44-10" class="hljs-ln-code"><a></a>bounds <span class="op">=</span> (np.array([<span class="fl">0.0</span>, <span class="fl">0.0</span>]), np.array([np.inf, <span class="fl">5.0</span>]))</span>
<span id="cb44-11" class="hljs-ln-code"><a></a></span>
<span id="cb44-12" class="hljs-ln-code"><a></a>res <span class="op">=</span> least_squares(residuals, p0, </span>
<span id="cb44-13" class="hljs-ln-code"><a></a>                    bounds<span class="op">=</span>bounds, </span>
<span id="cb44-14" class="hljs-ln-code"><a></a>                    args<span class="op">=</span>(t_exp, y_exp), </span>
<span id="cb44-15" class="hljs-ln-code"><a></a>                    kwargs<span class="op">=</span>{<span class="st">"sigma"</span>: sigma})</span>
<span id="cb44-16" class="hljs-ln-code"><a></a>lam_fit, omega_fit <span class="op">=</span> res.x </span>
<span id="cb44-17" class="hljs-ln-code"><a></a></span>
<span id="cb44-18" class="hljs-ln-code"><a></a>y_fit <span class="op">=</span> damped_sine(t_exp, lam_fit, omega_fit)  </span>
<span id="cb44-19" class="hljs-ln-code"><a></a>plt.figure()</span>
<span id="cb44-20" class="hljs-ln-code"><a></a>plt.scatter(t_exp, y_exp, s<span class="op">=</span><span class="dv">10</span>, alpha<span class="op">=</span><span class="fl">0.6</span>, label<span class="op">=</span><span class="st">"Noisy experimental data"</span>)  </span>
<span id="cb44-21" class="hljs-ln-code"><a></a>plt.plot(t_exp, y_fit, lw<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f"Least squares fit: Œª=</span><span class="sc">{</span>lam_fit<span class="sc">:.3f}</span><span class="ss">, œâ=</span><span class="sc">{</span>omega_fit<span class="sc">:.3f}</span><span class="ss">"</span>)  </span>
<span id="cb44-22" class="hljs-ln-code"><a></a>plt.xlabel(<span class="st">"t (Experimental Time)"</span>)</span>
<span id="cb44-23" class="hljs-ln-code"><a></a>plt.ylabel(<span class="st">"y (Observed Data)"</span>)</span>
<span id="cb44-24" class="hljs-ln-code"><a></a>plt.title(<span class="st">"Fit y = e^{-Œªt} sin(œât) with least_squares"</span>)</span>
<span id="cb44-25" class="hljs-ln-code"><a></a>plt.legend()</span>
<span id="cb44-26" class="hljs-ln-code"><a></a>plt.tight_layout()</span>
<span id="cb44-27" class="hljs-ln-code"><a></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="results-1" class="slide level2">
<h2>Results</h2>
<p>After running the fitting procedure, we obtain estimates for the parameters <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(\omega\)</span>:</p>
<div id="aeeb51ed" class="cell" data-execution_count="25">
<div class="cell-output cell-output-stdout">
<pre><code>Estimated Œª = 0.50165 ¬± 5.15e-03 (true 0.5)
Estimated œâ = 3.14557 ¬± 5.16e-03 (true 3.14159)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/cell-26-output-2.png" width="949" height="468"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="how-to-fit-odes-parameters" class="slide level2">
<h2>How to fit ODEs parameters?</h2>
<p>Fitting parameters in ODE models follows the same approach, but with one additional step:</p>
<blockquote>
<p>your predicted values will be obtained from <code>solve_ivp</code> using the parameters to be estimated!</p>
</blockquote>
<p>Consider the following reaction scheme in two CSTRs in series: <span class="math display">\[
\begin{aligned}
\text{CSTR 1:} &amp;\quad A \xrightarrow{k_1} B \\
\text{CSTR 2:} &amp;\quad B \xrightarrow{k_2} C
\end{aligned}
\]</span></p>
<p>We want to estimate the kinetic parameters <span class="math inline">\(k_1\)</span> and <span class="math inline">\(k_2\)</span> from synthetic noisy data of species C concentration over time.</p>
</section>
<section id="setup-the-cstr-model" class="slide level2">
<h2>Setup the CSTR Model</h2>
<p><span class="math display">\[
\frac{dC_{ik}}{dt} = \frac{(C_{i,k-1} - C_{ik})}{\tau} + r_{ik}
\]</span></p>
<p>with <span class="math inline">\(i = A, B, C\)</span> (species) and <span class="math inline">\(k = 1, 2\)</span> (CSTRs).</p>
<div class="fragment">
<p>Model states: <span class="math inline">\(y = ([C_{A1}, C_{B1}, C_{B2}, C_{C2}])\)</span> with feed <span class="math inline">\(C_{A0}&gt;0\)</span>, <span class="math inline">\(C_{B0}=C_{C0}=0\)</span>.</p>
<ul>
<li class="fragment">CSTR 1: <span class="math inline">\(r_{A1} = k_1\,C_{A1}\)</span> (first-order in <span class="math inline">\(A\)</span>)</li>
<li class="fragment">CSTR 2: <span class="math inline">\(r_{B2} = k_2\,C_{B2}^2\)</span> (second-order in <span class="math inline">\(B\)</span>)</li>
</ul>
</div>
<div class="fragment">
<p>Now it‚Äôs your turn! Open the <a href="https://github.com/MattiaGalantii/PPT_2025_Introduction/blob/master/lecture_exercises_students/ode_fitting_students.ipynb">ode_fitting_students.ipynb</a> notebook and implement the fitting of the CSTR model parameters using <code>least_squares</code> and <code>solve_ivp</code>.</p>
</div>
</section>
<section id="solution-cstr-model" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Solution: CSTR Model</h2>
<p>You can find the solution in the <a href="https://github.com/MattiaGalantii/PPT_2025_Introduction/blob/master/notebooks/ode_fitting.ipynb">ode_fitting.ipynb</a> notebook.</p>
<p>First, we define the ODE model for the CSTRs:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb46" data-code-line-numbers="|1-2|4-12|"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb46-1" class="hljs-ln-code"><a></a><span class="kw">def</span> dydt(t, y, k1, k2, CA0, tau):</span>
<span id="cb46-2" class="hljs-ln-code"><a></a>    CA1, CB1, CB2, CC2 <span class="op">=</span> y</span>
<span id="cb46-3" class="hljs-ln-code"><a></a></span>
<span id="cb46-4" class="hljs-ln-code"><a></a>    r1 <span class="op">=</span> k1 <span class="op">*</span> CA1</span>
<span id="cb46-5" class="hljs-ln-code"><a></a>    dCA1 <span class="op">=</span> (CA0 <span class="op">-</span> CA1)<span class="op">/</span>tau <span class="op">-</span> r1</span>
<span id="cb46-6" class="hljs-ln-code"><a></a>    dCB1 <span class="op">=</span> (<span class="fl">0.0</span> <span class="op">-</span> CB1)<span class="op">/</span>tau <span class="op">+</span> r1</span>
<span id="cb46-7" class="hljs-ln-code"><a></a> </span>
<span id="cb46-8" class="hljs-ln-code"><a></a>    r2 <span class="op">=</span> k2 <span class="op">*</span> CB2<span class="op">**</span><span class="dv">2</span></span>
<span id="cb46-9" class="hljs-ln-code"><a></a>    dCB2 <span class="op">=</span> (CB1 <span class="op">-</span> CB2)<span class="op">/</span>tau <span class="op">-</span> r2</span>
<span id="cb46-10" class="hljs-ln-code"><a></a>    dCC2 <span class="op">=</span> (<span class="fl">0.0</span> <span class="op">-</span> CC2)<span class="op">/</span>tau <span class="op">+</span> r2</span>
<span id="cb46-11" class="hljs-ln-code"><a></a></span>
<span id="cb46-12" class="hljs-ln-code"><a></a>    <span class="cf">return</span> [dCA1, dCB1, dCB2, dCC2]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="solution-residuals-function" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Solution: Residuals Function</h2>
<p>Then, we write the residuals function that uses <code>solve_ivp</code> to simulate the model:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb47" data-code-line-numbers="|14|15-16|17-19|21-22"><pre class="sourceCode numberSource python number-lines code-with-copy" data-id="quarto-animate-code"><code class="sourceCode python hljs"><span id="cb47-1" class="hljs-ln-code"><a></a><span class="kw">def</span> dydt(t, y, k1, k2, CA0, tau):</span>
<span id="cb47-2" class="hljs-ln-code"><a></a>    CA1, CB1, CB2, CC2 <span class="op">=</span> y</span>
<span id="cb47-3" class="hljs-ln-code"><a></a></span>
<span id="cb47-4" class="hljs-ln-code"><a></a>    r1 <span class="op">=</span> k1 <span class="op">*</span> CA1</span>
<span id="cb47-5" class="hljs-ln-code"><a></a>    dCA1 <span class="op">=</span> (CA0 <span class="op">-</span> CA1)<span class="op">/</span>tau <span class="op">-</span> r1</span>
<span id="cb47-6" class="hljs-ln-code"><a></a>    dCB1 <span class="op">=</span> (<span class="fl">0.0</span> <span class="op">-</span> CB1)<span class="op">/</span>tau <span class="op">+</span> r1</span>
<span id="cb47-7" class="hljs-ln-code"><a></a> </span>
<span id="cb47-8" class="hljs-ln-code"><a></a>    r2 <span class="op">=</span> k2 <span class="op">*</span> CB2<span class="op">**</span><span class="dv">2</span></span>
<span id="cb47-9" class="hljs-ln-code"><a></a>    dCB2 <span class="op">=</span> (CB1 <span class="op">-</span> CB2)<span class="op">/</span>tau <span class="op">-</span> r2</span>
<span id="cb47-10" class="hljs-ln-code"><a></a>    dCC2 <span class="op">=</span> (<span class="fl">0.0</span> <span class="op">-</span> CC2)<span class="op">/</span>tau <span class="op">+</span> r2</span>
<span id="cb47-11" class="hljs-ln-code"><a></a></span>
<span id="cb47-12" class="hljs-ln-code"><a></a>    <span class="cf">return</span> [dCA1, dCB1, dCB2, dCC2]</span>
<span id="cb47-13" class="hljs-ln-code"><a></a></span>
<span id="cb47-14" class="hljs-ln-code"><a></a><span class="kw">def</span> residuals(x_params, t_exp, y_exp, sigma<span class="op">=</span><span class="fl">0.01</span>, CA0<span class="op">=</span><span class="fl">1.0</span>, tau<span class="op">=</span><span class="fl">1.0</span>):</span>
<span id="cb47-15" class="hljs-ln-code"><a></a>    k1, k2 <span class="op">=</span> x_params</span>
<span id="cb47-16" class="hljs-ln-code"><a></a>    y0 <span class="op">=</span> [<span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>]  </span>
<span id="cb47-17" class="hljs-ln-code"><a></a>    sol <span class="op">=</span> solve_ivp(</span>
<span id="cb47-18" class="hljs-ln-code"><a></a>        dydt, (t_exp[<span class="dv">0</span>], t_exp[<span class="op">-</span><span class="dv">1</span>]), y0, t_eval<span class="op">=</span>t_exp,</span>
<span id="cb47-19" class="hljs-ln-code"><a></a>        args<span class="op">=</span>(k1, k2, CA0, tau))</span>
<span id="cb47-20" class="hljs-ln-code"><a></a></span>
<span id="cb47-21" class="hljs-ln-code"><a></a>    y_pred <span class="op">=</span> sol.y[<span class="dv">3</span>]  <span class="co"># CC2(t)</span></span>
<span id="cb47-22" class="hljs-ln-code"><a></a>    <span class="cf">return</span> (y_exp <span class="op">-</span> y_pred) <span class="op">/</span> sigma</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="solution-performing-the-fit" class="slide level2">
<h2>Solution: Performing the Fit</h2>
<p>Finally, we perform the fitting using <code>least_squares</code>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a></a>p0 <span class="op">=</span> np.array([<span class="fl">0.5</span>, <span class="fl">0.3</span>])  <span class="co"># initial guess</span></span>
<span id="cb48-2"><a></a>bounds <span class="op">=</span> (np.array([<span class="fl">1e-8</span>, <span class="fl">1e-8</span>]), np.array([<span class="fl">5.0</span>, <span class="fl">5.0</span>]))</span>
<span id="cb48-3"><a></a></span>
<span id="cb48-4"><a></a>res <span class="op">=</span> least_squares(</span>
<span id="cb48-5"><a></a>    residuals, p0, bounds<span class="op">=</span>bounds,</span>
<span id="cb48-6"><a></a>    args<span class="op">=</span>(t_exp, C2_exp),</span>
<span id="cb48-7"><a></a>    kwargs<span class="op">=</span>{<span class="st">"sigma"</span>: sigma, <span class="st">"CA0"</span>: CA0, <span class="st">"tau"</span>: tau})</span>
<span id="cb48-8"><a></a></span>
<span id="cb48-9"><a></a>k1_fit, k2_fit <span class="op">=</span> res.x</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="solution-visualizing-the-results" class="slide level2">
<h2>Solution: Visualizing the Results</h2>
<p>We can visualize the fitted model against the noisy data:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb49" data-code-line-numbers="|1-6|8-16|"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a></a>y0_plot <span class="op">=</span> [<span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>]</span>
<span id="cb49-2"><a></a>sol_fit <span class="op">=</span> solve_ivp(</span>
<span id="cb49-3"><a></a>    dydt, (t_exp[<span class="dv">0</span>], t_exp[<span class="op">-</span><span class="dv">1</span>]), y0_plot, t_eval<span class="op">=</span>t_exp,</span>
<span id="cb49-4"><a></a>    args<span class="op">=</span>(k1_fit, k2_fit, CA0, tau),</span>
<span id="cb49-5"><a></a>)</span>
<span id="cb49-6"><a></a>C2_fit <span class="op">=</span> sol_fit.y[<span class="dv">3</span>]</span>
<span id="cb49-7"><a></a></span>
<span id="cb49-8"><a></a>plt.figure()</span>
<span id="cb49-9"><a></a>plt.scatter(t_exp, C2_exp, s<span class="op">=</span><span class="dv">12</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, label<span class="op">=</span><span class="st">"Noisy experimental $C_2(t)$"</span>)</span>
<span id="cb49-10"><a></a>plt.plot(t_exp, C2_fit, lw<span class="op">=</span><span class="dv">2</span>, label<span class="op">=</span><span class="ss">f"Fit: k1=</span><span class="sc">{</span>k1_fit<span class="sc">:.3f}</span><span class="ss">, k2=</span><span class="sc">{</span>k2_fit<span class="sc">:.3f}</span><span class="ss">"</span>, color<span class="op">=</span><span class="st">"tab:red"</span>)</span>
<span id="cb49-11"><a></a>plt.xlabel(<span class="st">"time"</span>)</span>
<span id="cb49-12"><a></a>plt.ylabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">C_2</span><span class="dv">$</span><span class="vs"> </span><span class="kw">(</span><span class="vs">outlet of CSTR 2</span><span class="kw">)</span><span class="vs">"</span>)</span>
<span id="cb49-13"><a></a>plt.title(<span class="st">"Two CSTRs in series ‚Äî fit $k_1$ and $k_2$)"</span>)</span>
<span id="cb49-14"><a></a>plt.legend()</span>
<span id="cb49-15"><a></a>plt.tight_layout()</span>
<span id="cb49-16"><a></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="solution-visualizing-the-results-1" class="slide level2">
<h2>Solution: Visualizing the Results</h2>
<div id="94c1687d" class="cell" data-execution_count="26">
<div class="cell-output cell-output-stdout">
<pre><code>k1 = 0.8119 ¬± 0.0083   (true 0.8000)
k2 = 1.4291 ¬± 0.0473   (true 1.5000)</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="index_files/figure-revealjs/cell-27-output-2.png" width="947" height="467"></p>
</figure>
</div>
</div>
</div>
</section></section>
<section>
<section id="conclusions" class="title-slide slide level1 center">
<h1><i class="fa-solid fa-flag-checkered" aria-label="flag-checkered"></i> Conclusions</h1>
<p>This <strong>crash course</strong> introduced several key concepts in process technology modeling and simulation using <strong>Python</strong>:</p>
<ul>
<li class="fragment"><p><strong>Python foundations</strong><br>
Basic syntax, NumPy arrays, and SciPy tools for scientific computing.</p></li>
<li class="fragment"><p><strong>Solving ODEs</strong><br>
Setting up and integrating process models with <code>solve_ivp</code>.</p></li>
<li class="fragment"><p><strong>Parameter estimation</strong><br>
Fitting dynamic models to experimental data using <code>least_squares</code>.</p></li>
</ul>
<div class="fragment">
<p>By mastering these tools, you are now equipped to tackle <strong>complex process modeling</strong> problems.</p>
</div>
</section>
<section id="extra-resources" class="slide level2">
<h2>Extra Resources</h2>
<p>Extra materials and exercises are available to further enhance your understanding:</p>
<ul>
<li><a href="https://github.com/MattiaGalantii/PPT_2025_Introduction/blob/master/extra_material/tutorial1.ipynb">Python basics tutorial - 1</a></li>
<li><a href="https://github.com/MattiaGalantii/PPT_2025_Introduction/blob/master/extra_material/tutorial2.ipynb">Python basics tutorial - 2</a></li>
<li><a href="https://github.com/MattiaGalantii/PPT_2025_Introduction/blob/master/extra_material/homework1.ipynb">Homeworks - 1</a></li>
<li><a href="https://github.com/MattiaGalantii/PPT_2025_Introduction/blob/master/extra_material/homework2.ipynb">Homeworks - 2</a></li>
<li><a href="https://github.com/MattiaGalantii/PPT_2025_Introduction/blob/master/extra_material/extra_exercises.ipynb">Extra notebooks</a></li>
</ul>
<p><strong><i class="fa-solid fa-face-smile-wink" aria-label="face-smile-wink"></i> Happy coding!</strong></p>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="assets/TUe_logo.png" class="slide-logo"></p>
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-pointer/pointer.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'pointer': {"key":"q","color":"red","pointerSize":16,"alwaysVisible":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        maxScale: 1.4,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealPointer, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
          const outerScaffold = trigger.parentElement.cloneNode(true);
          const codeEl = outerScaffold.querySelector('code');
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp("https:\/\/MattiaGalantii\.github\.io\/PPT_intro_slides");
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    <script>videojs(video_shortcode_videojs_video1);</script>
    <script>videojs(video_shortcode_videojs_video2);</script>
    

</body></html>